/**
 * id: wERC
 * path: ./contextmenu
 */

(function(require,module,exports) {
"use strict";var e,t=this&&this.__assign||function(){return(t=Object.assign||function(e){for(var t,n=1,a=arguments.length;n<a;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)},n=this&&this.__classPrivateFieldGet||function(e,t){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return t.get(e)},a=this&&this.__classPrivateFieldSet||function(e,t,n){if(!t.has(e))throw new TypeError("attempted to set private field on non-instance");return t.set(e,n),n},i=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});var r=require("@bilibili-live/web-player-common"),u=i(require("./index.less")),o=function(){function i(){this.menuContainer=null,e.set(this,{})}return i.prototype.show=function(e,t){void 0===t&&(t=!1),t?this.menuContainer.classList.add(u.default["left-sub-menu"]):this.menuContainer.classList.remove(u.default["left-sub-menu"]);var n=this.menuContainer.style;n.top=e.top+"px",n.left=e.left+"px",n.opacity="1"},i.prototype.hide=function(){var e=this.menuContainer.style;e.top="",e.left="",e.opacity="0"},i.prototype.initContextmenu=function(e){this.menuContainer=this.createMenuUl(u.default["web-player-context-menu"]);var t=this.createContextmenuList(e);this.menuContainer.appendChild(t)},i.prototype.prependMenuItem=function(e,n){var a=t(t({},n),{name:e}),i=this.createMenuElement(a);return this.menuContainer.prepend(i),function(){i.remove()}},i.prototype.resetSubmenu=function(t,a,i,r){var o;void 0===r&&(r=-1);var l=n(this,e)[t];if(null!=l){var s=null!==(o=l.querySelector(u.default["context-sub-menu"]))&&void 0!==o?o:this.createMenuUl(u.default["context-sub-menu"]);s.innerHTML="";var c=a.map(function(e){return{label:e.label,value:e.value,disable:e.value===r,click:i.bind(null,e.value)}}),d=this.createSubmenuFragment(c);s.appendChild(d),l.appendChild(s)}},i.prototype.submenuActive=function(t,a){var i,r=n(this,e)[t];if(null!=r){for(var o=0,l=r.getElementsByClassName(u.default["context-sub-menu-item"]);o<l.length;o++){l[o].classList.remove(u.default.disabled)}null===(i=r.getElementsByClassName(u.default["context-sub-menu-item"])[a])||void 0===i||i.classList.add(u.default.disabled)}},i.prototype.createMenuUl=function(e){return void 0===e&&(e=""),r.createElement("ul",{classname:e})},i.prototype.createArrow=function(){return r.createElement("div",{classname:u.default["context-menu-right-arrow"]})},i.prototype.createMenuLi=function(e){var n=t({disable:!1,hr:!1,remove:!1},e),a=u.default.disabled,i=u.default["menu-item-hr"];return r.createElement("li",{classname:e.classname+(n.disable?" "+a:"")+(n.hr?" "+i:""),text:"",attributes:n.remove?[["data-auto-remove","1"]]:[]})},i.prototype.createSubmenuLi=function(e){var n=t({disable:!1,icon:""},e),a=u.default.disabled,i=r.createElement("li",{classname:n.classname+(n.disable?" "+a:""),text:n.text});if(""!==n.icon){var o=r.createElement("span",{classname:u.default[n.icon]});i.prepend(o)}return i.onclick=function(){!i.className.includes(u.default.disabled)&&n.click(n.index)},i},i.prototype.createContextmenuList=function(e){var t=this,n=document.createDocumentFragment();return e.forEach(function(e){n.appendChild(t.createMenuElement(e))}),n},i.prototype.createMenuElement=function(t){var a=this,i=t.name,o=t.label,l=t.click,s=t.hr,c=void 0!==s&&s,d=t.submenu,m=void 0===d?null:d,p=t.autoRemove,f=void 0!==p&&p,h=this.createMenuLi({text:o,classname:u.default["context-menu-item"],disable:"function"!=typeof l&&null==m,remove:f,hr:c}),v=r.createElement("span",{text:o,classname:u.default["context-menu-text"]});if(h.appendChild(v),null!=l&&h.addEventListener("click",function(){l(),a.hide()}),null!=m){h.appendChild(this.createArrow());var b=this.createMenuUl(u.default["context-sub-menu"]),y=this.createSubmenuFragment(m);b.appendChild(y),h.appendChild(b)}return f||(n(this,e)[i]=h),h},i.prototype.createSubmenuFragment=function(e){var t=this,n=document.createDocumentFragment();return e.forEach(function(e,a){var i,r=t.createSubmenuLi({text:e.label,classname:u.default["context-sub-menu-item"],disable:e.disable,icon:null!==(i=e.icon)&&void 0!==i?i:"",index:a,click:function(){e.click(),t.hide()}});n.appendChild(r)}),n},i.prototype.removeMenuItems=function(){for(var e=this.menuContainer.querySelectorAll('[data-auto-remove="1"]'),t=e.length-1;t>=0;t--){var n=e[t];this.menuContainer.removeChild(n)}},i.prototype.destroy=function(){this.menuContainer.innerHTML="",a(this,e,{})},i}();e=new WeakMap,exports.default=o;
})()