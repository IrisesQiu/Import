/**
 * id: lV3a
 * path: @bilibili-live/fmp4.js
 */

(function(require,module,exports) {
var define;
var t;!function(e,r){"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof t&&t.amd?t([],r):"object"==typeof exports?exports.fmp4=r():e.fmp4=r()}(self,()=>{return t={958:(t,e,r)=>{function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===i(a)?a:String(a)),n)}var a}function a(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=r(754),u=r(954),l=r(380),h=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],c=[44100,48e3,32e3,-1],f=function(t,e){return 1===e&&(e=2),"mp4a."+t.toString(16)+(e?"."+e.toString():"")},d=a(function t(e,r,i,n,a){o(this,t),this.profile=r,this.rate=i,this.channel=n,this.frame=a,this.codecs=f(e,r)}),_=a(function t(e,r,i,n){o(this,t),this.width=e,this.height=r,this.nalu=i,this.codecs=n});t.exports={audioTypeAAC:64,audioTypeMP3:107,getAacCodec:f,parseAudioInfo:function(t,e){if(64===e){if(t.length<2)return null;var r=t[0]>>>3&31,i=(7&t[0])<<1|t[1]>>>7&1,n=t[1]>>3&15;return new d(e,r,h[i],n,1024)}if(107===e){if(t.length<4)return null;var a=t[1]>>>3&3,o=t[1]>>>1&3;if(o<1||o>3)return null;var s,u,l=t[2]>>>2&3,f=3==(t[3]>>>6&3)?1:2;switch(a){case 3:s=c[l];break;case 2:s=c[l]>>>1;break;default:s=c[l]>>>2}switch(o){case 3:u=3===a?1152:576;break;case 2:u=1152;break;default:u=384}return new d(e,0,s,f,u)}return null},parseVideoInfo:function(t,e){var r;if(-7===e)r=new u.AvcParser;else if(-12===e)r=new l.HevcParser;else{if(-14!==e)return null;r=new s.Av1Parser}if(0!==r.parse(t))return null;var i=r.displaySize;return new _(i.width,i.height,r.nalu,r.codecs)}}},754:(t,e,r)=>{function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===i(a)?a:String(a)),n)}var a}function o(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var s=r(757),u=r(819).BitStream,l=function(){function t(){n(this,t),this.max_frame_width_minus_1=0,this.max_frame_height_minus_1=0}return o(t,[{key:"parse",value:function(t){var e,r,i,n,a=[],o=0,s=0,u=0,l=0,h=[],c=[],f=[],d=[],_=[],y=[],p=[],v=[],m=function(t,e){var r=s+1;d[e]=t.readBits(r),_[e]=t.readBits(r),y[e]=t.readBits(1)};if(n=t.readBits(3),t.readBits(1),0!=(e=t.readBits(1)))a[0]=t.readBits(5);else{0!=t.readBits(1)?(function(t){t.readBits(32),t.readBits(32),0!=t.readBits(1)&&function(t){for(var e=0;1!=t.readBits(1);)e++;if(e>=32)return 4294967295;var r=(1<<e)-1;r<0&&(r+=4294967296),e>0&&t.readBits(e)}(t)}(t),0!=(o=t.readBits(1))&&function(t){s=t.readBits(5),t.readBits(32),t.readBits(5),t.readBits(5)}(t)):o=0,u=t.readBits(1),l=t.readBits(5);for(var b=0;b<=l;b++)h[b]=t.readBits(12),a[b]=t.readBits(5),a[b]>7?c[b]=t.readBits(1):c[b]=0,0!=o?(f[b]=t.readBits(1),0!=f[b]&&m(t,b)):f[b]=0,0!=u&&(p[b]=t.readBits(1),0!=p[b]&&(v[b]=t.readBits(4)))}r=t.readBits(4),i=t.readBits(4),this.max_frame_width_minus_1=t.readBits(r+1),this.max_frame_height_minus_1=t.readBits(i+1),0!=(0!=e?0:t.readBits(1))&&(t.readBits(4),t.readBits(3)),t.readBits(1),t.readBits(1),t.readBits(1);var g=0;return 0!=e?g=0:(t.readBits(1),t.readBits(1),t.readBits(1),t.readBits(1),0!=(g=t.readBits(1))&&(t.readBits(1),t.readBits(1)),(0!=t.readBits(1)?0:t.readBits(1))>0&&(0!=t.readBits(1)||t.readBits(1)),0!=g&&t.readBits(3)),t.readBits(1),t.readBits(1),t.readBits(1),function(t){var e,r=t.readBits(1),i=0;2==n&&0!=r?i=t.readBits(1)?12:10:n<=2&&(i=r?10:8),e=1==n?0:t.readBits(1);var a=0,o=0,s=0;0!=t.readBits(1)?(a=t.readBits(8),o=t.readBits(8),s=t.readBits(8)):(a=2,o=2,s=2);var u=0,l=0;if(e)return t.readBits(1),u=1,void(l=1);1==a&&13==o&&0==s?(u=0,l=0):(t.readBits(1),0==n?(u=1,l=1):1==n?(u=0,l=0):12==i?l=(u=t.readBits(1))?t.readBits(1):0:(u=1,l=0),u&&l&&t.readBits(2)),t.readBits(1)}(t),t.readBits(1),t.getOffset()}},{key:"displaySize",get:function(){return{width:this.max_frame_width_minus_1+1,height:this.max_frame_height_minus_1+1}}}]),t}(),h=function(){function t(){n(this,t),this.seq_profile=0,this.seq_level_idx_0=0,this.seq_tier_0=0,this.high_bitdepth=0,this.twelve_bit=0,this.nalu=1,this.config_obus=[],this.onCustomData=void 0}return o(t,[{key:"onMetadataUserData",value:function(e){for(var r=new u(e);r.getOffset().bytes<e.length&&!(r.getOffset().bytes+1>=e.length);){var i=t.parseLeb128(r),n=r.getOffset().bytes,a=e.subarray(n,n+i);a.length>=16&&this.onCustomData&&this.onCustomData(a.slice(0,16),a.slice(16)),r.setOffset(n+i,0)}}},{key:"parse",value:function(t){this.seq_profile=t[1]>>>5,this.seq_level_idx_0=31&t[1],this.seq_tier_0=t[2]>>>7,this.high_bitdepth=t[2]>>>6&1,this.twelve_bit=t[2]>>>5&1;var e=t.subarray(4,t.length);return this.parseObus(e),0}},{key:"parseObus",value:function(e){for(var r=new u(e);r.getOffset().bytes<e.length;){var i=t.parseObuHeader(r),n=void 0;0!==i.obu_has_size_field&&(n=t.parseLeb128(r));var a=r.getOffset().bytes,o=8*r.getOffset().bytes+r.getOffset().bits;switch(0===i.obu_has_size_field&&(n=e.length-a),i.obu_type){case 1:var s=new l;s.parse(r),this.config_obus.push(s);break;case 5:var h=t.parseLeb128(r),c=r.getOffset().bytes,f=e.subarray(c,a+n);7==h&&this.onMetadataUserData(f)}var d=8*r.getOffset().bytes+r.getOffset().bits-o;n>0&&4!=i.obu_type&&8!=i.obu_type&&6!=i.obu_type&&t.trailingBits(r,8*n-d),r.setOffset(a+n,0)}}},{key:"codecs",get:function(){var t;return t=2===this.seq_profile&&this.high_bitdepth?this.twelve_bit?12:10:this.high_bitdepth?10:8,"av01."+this.seq_profile+"."+s.to02uString(this.seq_level_idx_0)+(this.seq_tier_0?"H":"M")+"."+s.to02uString(t)}},{key:"displaySize",get:function(){var t=this.config_obus.length?this.config_obus[0].displaySize:null;return t||(t={width:1280,height:720}),t}}],[{key:"parseLeb128",value:function(t){for(var e=0,r=0;r<8;r++){var i=t.readBits(8);if(e|=(127&i)<<7*r,!(128&i))break}return e<0&&(e+=4294967296),e}},{key:"obuExtensionHeader",value:function(t){var e={};return e.temporal_id=t.readBits(3),e.spatial_id=t.readBits(2),e.extension_header_reserved_3bits=t.readBits(3),e}},{key:"parseObuHeader",value:function(e){var r={};return r.obu_forbidden_bit=e.readBits(1),r.obu_type=e.readBits(4),r.obu_extension_flag=e.readBits(1),r.obu_has_size_field=e.readBits(1),r.obu_reserved_1bit=e.readBits(1),1==r.obu_extension_flag&&(r.obu_ext_header=t.obuExtensionHeader(e)),r}},{key:"trailingBits",value:function(t,e){for(t.readBit(),e--;e>0;)t.readBit(),e--}}]),t}();t.exports={Av1Parser:h}},954:(t,e,r)=>{function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===i(a)?a:String(a)),n)}var a}function o(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var s=r(819).BitStream,u=r(757),l=function(){function t(){n(this,t),this.width=0,this.height=0}return o(t,[{key:"parse",value:function(t){var e=new s(t),r=1,i=this.profile_idc=e.readBits(8),n=e.readBits(8),a=(this.compatibility=n,this.level_idc=e.readBits(8),e.readUe(),0);if((100===i||110===i||122===i||244===i||44===i||83===i||86===i||118===i||128===i||138===i||139===i||134===i||135===i)&&(3===(r=e.readUe())&&(a=e.readBit()),e.readUe(),e.readUe(),e.readBit(),0!==e.readBit()))for(var o=0;o<(3!==r?8:12);o++)e.readBit();e.readUe();var u=e.readUe();if(0===u)e.readUe();else if(1===u){e.readBit(),e.readSe(),e.readSe();var l=e.readUe();for(o=0;o<l;o++)e.readSe()}e.readUe(),e.readBit();var h=e.readUe(),c=e.readUe(),f=e.readBit();0===f&&e.readBit(),e.readBit();var d=e.readBit(),_=0,y=0,p=0,v=0;0!==d&&(_=e.readUe(),y=e.readUe(),p=e.readUe(),v=e.readUe()),e.readBit();var m,b=h+1,g=(c+1)*(2-(0!==f?1:0)),k=0!==f?1:0,w=0!==a?0:r;m=w>3?null:0===w?{dx:1,dy:2-k}:{dx:[0,2,2,1][w],dy:[0,2,1,1][w]*(2-k)};var S=0!==d,B=S?_*m.dx:0,P=S?p*m.dy:0,T=S?y*m.dx:0,M=S?v*m.dy:0;this.width=16*b-T-B,this.height=16*g-M-P}},{key:"displaySize",get:function(){return{width:this.width,height:this.height}}}]),t}(),h=function(){function t(){n(this,t),this.verison=0,this.profile=0,this.compatibility=0,this.level=0,this.nalu=4,this.sps=[]}return o(t,[{key:"parse",value:function(t){var e=t.length;if(e<7)return-1;this.version=t[0],this.profile=t[1],this.compatibility=t[2],this.level=t[3],this.nalu=1+(3&t[4]);var r=31&t[5];if(0===r)return-1;for(var i=6,n=0;n<r&&i+2<e;++n){var a=t[i]<<8|t[i+1];if(a+i+2+1>=e)return-1;try{var o=t.subarray(i+2+1,i+2+a-1),s=new l;s.parse(o),this.sps.push(s),0===n&&(this.profile=s.profile_idc,this.compatibility=-4&s.compatibility,this.level=s.level_idc)}catch(t){console.warn("parse avc-sps error")}i+=a+2}return 0}},{key:"codecs",get:function(){return"avc1."+u.to02xString(this.profile)+u.to02xString(this.compatibility)+u.to02xString(this.level)}},{key:"displaySize",get:function(){var t=this.sps.length?this.sps[0].displaySize:null;return t||(t={width:1280,height:720}),t}}]),t}();t.exports.AvcParser=h},819:t=>{function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,r){for(var i=0;i<r.length;i++){var n=r[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=function(t,r){if("object"!==e(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!==e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===e(a)?a:String(a)),n)}var a}var i=[0,16,1,2,4,8,32,3,5,10,12,15,47,7,11,13,14,6,9,31,35,37,42,44,33,34,36,40,39,43,45,46,17,18,20,24,19,21,26,28,23,27,29,30,22,25,38,41],n=[47,31,15,0,23,27,29,30,7,11,13,14,39,43,45,46,16,3,5,10,12,19,21,26,28,35,37,42,44,1,2,4,8,17,18,20,24,6,9,22,25,32,33,34,36,40,38,41],a=[15,0,7,11,13,14,3,5,10,12,1,2,4,8,6,9],o=[0,1,2,4,8,3,5,10,12,15,7,11,13,14,6,9],s=function(t){!1===t&&console.warn(t)},u=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._data=e,this._bytes=e.length,this._offsetBits=0,this._offsetBytes=0}var e,u;return e=t,(u=[{key:"moveNextBit",value:function(){++this._offsetBits,this._offsetBits>=8&&(this._offsetBits%=8,this._offsetBytes+1<=this._bytes&&(++this._offsetBytes,this._offsetBytes<this._bytes&&3===this._data[this._offsetBytes]&&this._offsetBytes>1&&0===this._data[this._offsetBytes-1]&&0===this._data[this._offsetBytes-2]&&++this._offsetBytes))}},{key:"getOffset",value:function(){return{bytes:this._offsetBytes,bits:this._offsetBits}}},{key:"setOffset",value:function(t,e){return t>this._bytes||e>8?-1:(this._offsetBits=e,this._offsetBytes=t,0)}},{key:"nextBit",value:function(){return s(this._data&&this._bytes>0),this._offsetBytes>=this._bytes?-1:this._data[this._offsetBytes]>>>7-this._offsetBits&1}},{key:"nextBits",value:function(e){var r=new t(this._data);return r._offsetBits=this._offsetBits,r._offsetBytes=this._offsetBytes,r.readBits(e)}},{key:"readBit",value:function(){if(s(this._data&&this._bytes>0),this._offsetBytes>=this._bytes)return-1;var t=this._data[this._offsetBytes]>>>7-this._offsetBits&1;return this.moveNextBit(),s(0===t||1===t),t}},{key:"readBits",value:function(t){s(t>0&&t<=32);for(var e=0,r=0,i=0;r<t&&-1!==i;r++)i=this.readBit(),s(0===i||1===i),e=e<<1|i;return e}},{key:"readBool",value:function(){return 1===this.readBit()}},{key:"readUe",value:function(){var t,e=-1;for(t=0;!t&&-1!==t;++e)t=this.readBit(),s(0===t||1===t);return t=0,e>0&&(s(e<32),t=this.readBits(e)),(1<<e)-1+t}},{key:"readSe",value:function(){var t=this.readUe();return(t+1)/2*(0==t%2?-1:1)}},{key:"readMe",value:function(t,e){var r=this.readUe();return t?(s(r>=0&&r<48),0!==e?i[r]:n[r]):(s(r>=0&&r<16),0!==e?a[r]:o[r])}},{key:"readTe",value:function(){var t=this.readUe();return 1!==t?t:0!==this.readBit()?0:1}}])&&r(e.prototype,u),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.exports.BitStream=u},380:(t,e,r)=>{function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===i(a)?a:String(a)),n)}var a}function o(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var s=r(819).BitStream,u=function(){function t(){n(this,t),this.pic_width_in_luma_samples=0,this.pic_height_in_luma_samples=0}return o(t,[{key:"parse",value:function(t){var e=new s(t);e.readBits(16),e.readBits(4);var r=e.readBits(3);e.readBool(),this.general_profile_space=e.readBits(2),this.general_tier_flag=e.readBool(),this.general_profile_idc=e.readBits(5),this.general_profile_compatibility_flags=e.readBits(32),e.readBool(),e.readBool(),e.readBool(),e.readBool(),e.readBits(32),e.readBits(12),this.general_level_idc=e.readBits(8);for(var i=[],n=[],a=0;a<r;++a)i.push(e.readBool()),n.push(e.readBool());if(r>0)for(a=r;a<8;++a)e.readBits(2);for(a=0;a<r;++a)i[a]&&e.readBits(88),n[a]&&e.readBits(8);e.readUe(),3===e.readUe()&&e.readBool(),this.pic_width_in_luma_samples=e.readUe(),this.pic_height_in_luma_samples=e.readUe()}},{key:"displaySize",get:function(){return{width:this.pic_width_in_luma_samples,height:this.pic_height_in_luma_samples}}}]),t}(),l=function(){function t(){n(this,t),this.general_profile_space=0,this.general_profile_idc=0,this.general_level_idc=0,this.general_tier_flag=0,this.general_profile_compatibility_flags=0,this.nalu=4,this.sps=[]}return o(t,[{key:"parse",value:function(t){var e=t.length;if(e<23)return-1;if(1!==t[0])return-1;this.general_profile_space=t[1]>>6&3,this.general_tier_flag=t[1]>>5&1,this.general_profile_idc=31&t[1],this.general_profile_compatibility_flags=t[2]<<24|t[3]<<16|t[4]<<8|t[5];var r=t[6]<<24|t[7]<<16|t[8]<<8|t[9];r=r<<16|t[10]<<8|t[11],this.general_level_idc=t[12],this.nalu=1+(3&t[21]);for(var i=t[22],n=23,a=0;a<i;a++){if(n+3>t+e)return-1;var o=t[n],s=t[n+1]<<8|t[n+2];n+=3;for(var l=0;l<s;l++){if(n+2>e)return-1;var h=t[n]<<8|t[n+1];if(n+2+h>e)return-1;if(33==(63&o))try{var c=t.subarray(n+2,n+2+h),f=new u;f.parse(c),this.sps.push(f),0==l&&(this.general_profile_compatibility_flags=f.general_profile_compatibility_flags,this.general_profile_space=f.general_profile_space,this.general_profile_idc=f.general_profile_idc,this.general_tier_flag=f.general_tier_flag?1:0,this.general_level_idc=f.general_level_idc)}catch(t){console.warn("parse hevc-sps error")}n+=2+h}}return 0}},{key:"codecs",get:function(){var t=this.general_profile_compatibility_flags;return t=(t=(t=(t=(t=t>>1&1431655765|(1431655765&t)<<1)>>2&858993459|(858993459&t)<<2)>>4&252645135|(252645135&t)<<4)>>8&16711935|(16711935&t)<<8)>>16|t<<16,"hvc1."+["","A","B","C"][this.general_profile_space%4]+this.general_profile_idc.toString()+"."+t.toString(16).toLowerCase()+"."+["L","H"][this.general_tier_flag%2]+this.general_level_idc.toString()}},{key:"displaySize",get:function(){var t=this.sps.length?this.sps[0].displaySize:null;return t||(t={width:1280,height:720}),t}}]),t}();t.exports.HevcParser=l},757:t=>{var e=[[0,200,0,128,35,128],[33,0,73,144,2,25,0,35,128],[0,200,0,128,32,132,1,38,64,8,100,0,142],[0,200,0,128,32,132,1,38,64,8,100,0,128,44,128,8,2,56],[0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,56],[0,200,0,128,32,132,1,38,64,8,100,0,130,48,4,153,0,33,144,2,0,178,0,32,8,224]],r=[[1,64,34,128,163,78,230,128,186,8,0,0,0,28,6,241,193,10,90,90],[1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10],[1,64,34,128,163,94,230,128,186,8,0,0,0,0,149,0,6,241,161,10]],i=[90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,90,94];function n(t,e,r){for(;e<r;)if(3!==t[e]&&0!==t[e])e+=3;else{if(0===t[e-2]&&0===t[e-1]&&3===t[e])return e-2;e+=1}return null}t.exports={getSilentFrame:function(t,n){if(2===t){if(n>=1&&n<=6)return new Uint8Array(e[n-1])}else if(n>=1&&n<=3)return new Uint8Array(r[n-1].concat(i));return null},ebsp2rbsp:function(t){for(var e=t,r=e.byteLength,i=new Uint8Array(r),a=0,o=0;;){var s=n(e,o,r);if(null===s)break;i.set(e.subarray(o,s+2),a),a+=s-o+2,o=s+3}return i.set(e.subarray(o,e.length),a),a+=e.length-o,i.subarray(0,a)},to02uString:function(t){var e=t.toString(10);return e.length<2&&(e="0"+e),e},to02xString:function(t){var e=t.toString(16);return e.length<2&&(e="0"+e),e},equalsUuid:function(t,e){if(16!==t.length||16!==e.length)return!1;for(var r=0;r<16;++r)if(t[r]!==e[r])return!1;return!0}}},319:t=>{t.exports={SomeError:function(t,e){this.name=t,this.message=e,this.stack=(new Error).stack},errorAudioInfo:10001,errorVideoInfo:10002,errorAudioTrack:10003,errorVideoTrack:10004,errorUnknownCodec:10005,errorFlvPacket:10006,errorFlvDts:10007,errorNetworkTimeout:11e3,errorNetworkFetch:11001,errorNetworkRead:11002,errorMseOpen:11003,errorMseAppend:11004,errorM3u8Data:11010,errorMp4Data:11011,errorMp4Dts:11012,errorM3u8NotUpdate:11013,errorSwitchCrash:11020,errorSwitchTimeNotMatch:11021,errorSwitchCancel:11022}},809:(t,e,r)=>{function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(){return(n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(i){var n=Object.getOwnPropertyDescriptor(i,e);return n.get?n.get.call(arguments.length<3?t:r):n.value}}).apply(this,arguments)}function a(t,e){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=r(319),l=r(690),h=r(118),c=r(15).e,f=r(97).StreamFetcher,d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(y,t);var e,r,l,d,_=(l=y,d=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=s(l);if(d){var r=s(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return o(t)}(this,t)});function y(t,e){var r;return function(t,e){if(!(t instanceof y))throw new TypeError("Cannot call a class as a function")}(this),r=_.call(this,t,e),console.log("fMp4Player ".concat(r.version)),r.maxDuration=30,r.minDuration=10,r.startTime=0,r._contentLength=void 0,r._loader=null,r._readDone=!1,r._readPaused=!1,r._readPosition=0,r._fmp4Muxer=null,r._checkBufferInterval=void 0,r._onCheckBufferBinder=r._onCheckBuffer.bind(o(r)),r._onResponseBinder=r._onResponse.bind(o(r)),r._onDataFetchedBinder=r._onDataFetched.bind(o(r)),r._onDataConvertedBinder=r._onDataConverted.bind(o(r)),r._onMetaDataBinder=r._onMetaDataParsed.bind(o(r)),r._onConvertErrorBinder=r._onConvertError.bind(o(r)),r._onReadErrorBinder=r._onReadError.bind(o(r)),r}return e=y,(r=[{key:"version",get:function(){return"v1.42"}},{key:"destroy",value:function(){n(s(y.prototype),"destroy",this).call(this),void 0!==this._checkBufferInterval&&(window.clearInterval(this._checkBufferInterval),this._checkBufferInterval=void 0),this._firstPacketNotified=!1,this._readPaused=!1,this._readDone=!0,this._loader&&(this._loader.destroy(),this._loader=null),this._fmp4Muxer&&(this._fmp4Muxer.destroy(),this._fmp4Muxer=null),this._contentLength=void 0}},{key:"src",set:function(t){this.destroy(),this._setup(t),this._fetchUrl()}},{key:"createFetcher",value:function(t,e,r){return new f(t,e,r)}},{key:"_fetchUrl",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;this._contentLength=void 0,this._receivedBytes=0,this._readDone=!1,this._readPaused=!1,this._readPosition=t,this._loader=this.createFetcher(this._onResponseBinder,this._onDataFetchedBinder,this._onReadErrorBinder),this._loader.fetchAsStream(this._url,!1,t,-1,this._timeout)}},{key:"_onDataConverted",value:function(t){this._ensureMse(this._mimeType),this._pushBuffer(t)}},{key:"_onMetaDataParsed",value:function(t){var e=this;if(this._mimeType=this._fmp4Muxer.mimeType,this.onMetaData&&this.onMetaData(t),this._contentLength&&this.startTime>0){var r=t.keyframes;if(r&&r.times&&r.filepositions){var i=c(r.times,this.startTime);if(i>=0&&i<r.filepositions.length){var n=r.filepositions[i];r.times[i]>this.startTime&&i>0&&(n=r.filepositions[--i]),this._fmp4Muxer&&this._fmp4Muxer.reset(),console.log("seek to: ".concat(r.times[i],"/").concat(t.duration,"s, pos=").concat(n));var a=function(){e._seekToPosition(n)};window.Promise?Promise.resolve().then(a):window.setTimeout(a,0)}else console.warn("seek failed: ".concat(this.startTime,"/").concat(t.duration,"s"))}this.startTime=0}}},{key:"_onConvertError",value:function(t,e){this._notifyParserError(t,{url:this._url,info:e})}},{key:"_onReadError",value:function(t,e){this._notifyNetworkError(t,{url:this._url,info:e})}},{key:"_processFetchedData",value:function(t){this._fmp4Muxer?this._fmp4Muxer.input(t):this._onDataConverted(t)}},{key:"_seekToPosition",value:function(t){this._fmp4Muxer&&this._fmp4Muxer.reset(),this._loader&&(this._loader.destroy(),this._loader=null),this._fetchUrl(t)}},{key:"_onDataFetched",value:function(t){return!(this._isDestroied||(!this._firstPacketNotified&&this.onFirstPacket&&(this._firstPacketNotified=!0,this.onFirstPacket()),t?(this._removeOutdated(),this._processFetchedData(t),this._receivedBytes+=t.length,this._readPosition+=t.length):t||(this._readDone=void 0===this._contentLength||this._receivedBytes>=this._contentLength,this._readDone&&this._pushEnd()),this._readDone||this._readPaused))}},{key:"_onResponse",value:function(t){if(this._isDestroied)return!1;if(!t.ok)return this._notifyNetworkError(u.errorNetworkFetch,{url:this._url,status:t.status}),!1;!this._firstResponseNotified&&this.onFirstResponse&&(this._firstResponseNotified=!0,this.onFirstResponse(t));var e=t.headers.get("Content-Length"),r=e?parseInt(e):void 0;void 0===this._contentLength&&(this._contentLength=r),this._contentLength&&void 0===this._checkBufferInterval&&(this._checkBufferInterval=window.setInterval(this._onCheckBufferBinder,500));var i=t.headers.get("Content-Type");return i&&-1!==i.indexOf("video/mp4")?(this._mimeType=i,this._fmp4Muxer=null):null===this._fmp4Muxer&&(this._mimeType=null,this._fmp4Muxer=new h.fMp4Muxer(250,this._onDataConvertedBinder,this._onMetaDataBinder,this.onSeiData,this._onConvertErrorBinder)),!0}},{key:"_onCheckBuffer",value:function(){var t=this.buffered;t<=this.minDuration&&this._readPaused&&this._receivedBytes<this._contentLength?(this._readPaused=!1,this._loader.fetchAsStream(this._url,!1,this._readPosition,-1,this._timeout)):t>=this.maxDuration&&!this._readPaused&&(this._readPaused=!0)}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===i(a)?a:String(a)),n)}var a}(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),y}(l.LivePlayer);t.exports.R=d},521:(t,e,r)=>{function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(){return(n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=s(t)););return t}(t,e);if(i){var n=Object.getOwnPropertyDescriptor(i,e);return n.get?n.get.call(arguments.length<3?t:r):n.value}}).apply(this,arguments)}function a(t,e){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function o(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function s(t){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=r(319),l=r(690),h=r(97).Fetcher,c=r(909).t,f=r(615),d=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(y,t);var e,r,l,d,_=(l=y,d=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=s(l);if(d){var r=s(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return o(t)}(this,t)});function y(t,e){var r;return function(t,e){if(!(t instanceof y))throw new TypeError("Cannot call a class as a function")}(this),r=_.call(this,t,e),console.log("Hls7Player ".concat(r.version)),r._playlist=null,r._updateMasterPlaylistHandler=null,r._fetchM3u8Timer=void 0,r._fetchM3u8Binder=r._fetchM3u8.bind(o(r)),r._onM3u8ResponsedBinder=r._onM3u8Responsed.bind(o(r)),r._onM3u8FetchedBinder=r._onM3u8Fetched.bind(o(r)),r._onM3u8FetchErrorBinder=r._onM3u8FetchError.bind(o(r)),r._fetchedM4sCount=0,r._lastFetchM4sBegin=null,r._lastFetchM4sEnd=null,r._lastFetchM4sUrl=null,r._lastFetchInitM4sBegin=null,r._lastFetchM3u8Begin=null,r._lastFetchM3u8End=null,r._lastFetchMasterM3u8Begin=null,r._lastFetchM3u8=0,r._lastM3u8Sequence=0,r._lastM3u8Updated=0,r._initDone=!1,r._lastDuration=0,r._totalDuration=0,r._tryM3u8Times=0,r._pendingBuffers=[],r._onM4sResponsedBinder=r._onM4sResponsed.bind(o(r)),r._onM4sFetchedBinder=r._onM4sFetched.bind(o(r)),r._onM4sFetchErrorBinder=r._onM4sFetchError.bind(o(r)),r._mp4Parser=null,r._onM4sParsedBinder=r._onM4sParsed.bind(o(r)),r._m3u8Fetcher=new h(r._onM3u8ResponsedBinder,r._onM3u8FetchedBinder,r._onM3u8FetchErrorBinder),r._m4sFetcher=new h(r._onM4sResponsedBinder,r._onM4sFetchedBinder,r._onM4sFetchErrorBinder),r._savedFetchAsStream=r._m4sFetcher.fetchAsStream,r._minBufferLength=0,r._onPlaylistUpdate=function(t,e){},r._masterPlaylistProcessor=r._defaultMasterPlaylistProcessor.bind(o(r)),r._fetchSwitchPlaylistTimer=void 0,r._paddingSwitchPlaylistResolve=null,r._targetSwitchPlaylistUrl=null,r._trySwitchPlaylistCount=0,r._trySwitchPlaylistMaxCount=5,r._trimStartKeepTimeMs=0,r}return e=y,(r=[{key:"version",get:function(){return"v1.91"}},{key:"destroy",value:function(){n(s(y.prototype),"destroy",this).call(this),void 0!==this._fetchM3u8Timer&&(window.clearTimeout(this._fetchM3u8Timer),this._fetchM3u8Timer=void 0),this._fetchedM4sCount=0,this._mp4Parser=null,this._playlist=null,this._initDone=!1,this._lastDuration=0,this._lastM3u8Sequence=0,this._totalDuration=0,this._tryM3u8Times=0,this._pendingBuffers=[],this.cancelSwitchPlaylistUrl()}},{key:"setP2PContext",value:function(t){this._isDestroied||(t?(null!=t.P2PBufferLength&&(this._minBufferLength=t.P2PBufferLength),null!=t.P2PFetchAsStream&&(this._m4sFetcher.fetchAsStream=t.P2PFetchAsStream),null!=t.onPlaylistUpdate&&(this._onPlaylistUpdate=t.onPlaylistUpdate)):(this._minBufferLength=0,this._m4sFetcher.fetchAsStream=this._savedFetchAsStream,this._onPlaylistUpdate=function(t,e){}),this._playlist&&(this._playlist.onPlaylistUpdate=this._onPlaylistUpdate))}},{key:"getAudioTracks",value:function(){return this._mp4Parser?this._mp4Parser.getAudioTracks():[]}},{key:"switchAudioTrack",value:function(t){return!!this._mp4Parser&&this._mp4Parser.switchAudioTrack(t)}},{key:"cancelSwitchPlaylistUrl",value:function(){void 0!==this._fetchSwitchPlaylistTimer&&(window.clearTimeout(this._fetchSwitchPlaylistTimer),this._fetchSwitchPlaylistTimer=void 0),this._notifySwitchPlaylistResolve(u.errorSwitchCancel),this._targetSwitchPlaylistUrl=null,this._trySwitchPlaylistCount=0}},{key:"switchPlaylistUrl",value:function(t){var e=this;return new Promise(function(r){e.cancelSwitchPlaylistUrl(),e._paddingSwitchPlaylistResolve=r,e._targetSwitchPlaylistUrl=t})}},{key:"setMasterPlaylistProcessor",value:function(t){return"function"==typeof t?(this._masterPlaylistProcessor=t.bind(this),!0):(this._masterPlaylistProcessor=this._defaultMasterPlaylistProcessor.bind(this),!1)}},{key:"getHLSNetworkState",value:function(){var t=performance.now();return{m3u8LastUpdated:Math.round(t-this._lastM3u8Updated),m3u8LastSeq:this._lastM3u8Sequence,m3u8LastEnd:null==this._lastFetchM3u8End?null:Math.round(t-this._lastFetchM3u8End),m3u8LastStarted:null==this._lastFetchM3u8Begin?null:Math.round(t-this._lastFetchM3u8Begin),m4sLastStarted:null==this._lastFetchM4sBegin?null:Math.round(t-this._lastFetchM4sBegin),m4sLastEnd:null==this._lastFetchM4sEnd?null:Math.round(t-this._lastFetchM4sEnd),m4sPath:this._lastFetchM4sUrl}}},{key:"_defaultMasterPlaylistProcessor",value:function(t,e){return t[0]}},{key:"_notifySwitchPlaylistResolve",value:function(t){this._paddingSwitchPlaylistResolve&&(this._paddingSwitchPlaylistResolve(t),this._paddingSwitchPlaylistResolve=null)}},{key:"_updateTargetPlaylist",value:function(t){var e=this;this._prefetchM3u8(t,function(t,r,i){var n=e._playlist;r&&n&&n.switchToNewPlaylist(t,r)},function(t,e,r){console.warn("prefetch error: ".concat(r," (").concat(e,", ").concat(t,")"))},2e3,3)}},{key:"fetchedM4sCount",get:function(){return this._fetchedM4sCount}},{key:"minBufferLength",get:function(){return this._minBufferLength},set:function(t){this._minBufferLength=t}},{key:"trimStartKeepTimeMs",set:function(t){this._trimStartKeepTimeMs=t}},{key:"src",set:function(t){this.destroy(),this._setup(t),this._playlist=new f.M3u8Context(this._trimStartKeepTimeMs),this._playlist.onSwitchToNextPlaylist=this._onSwitchToNextPlaylist.bind(this),this._playlist.setUrl(this._url),this._playlist.onPlaylistUpdate=this._onPlaylistUpdate,this._mp4Parser=new c(this._onM4sParsedBinder,this.onSeiData),this._fetchM3u8()}},{key:"_onSwitchToNextPlaylist",value:function(t){t?(this._url=this._targetSwitchPlaylistUrl,this._paddingSwitchPlaylistResolve(0)):this._paddingSwitchPlaylistResolve(u.errorSwitchCrash),this.cancelSwitchPlaylistUrl()}},{key:"_initMasterPlaylistUpdater",value:function(t){var e=this;null!==this._updateMasterPlaylistHandler&&clearTimeout(this._updateMasterPlaylistHandler);var r=function(t,r,i){var n=performance.now()-e._lastFetchMasterM3u8Begin;e._lastFetchMasterM3u8Begin=null;var a=e._playlist;if(r&&a&&!e._isDestroied&&e.onMasterPlaylistUpdate){var o=new f.BasicM3u8Parser;o.parse(r)===f.parsedOk&&o.streams.length>0&&e.onMasterPlaylistUpdate(o.streams,o.streamInfMaps,o.steering),e._onUrlFetchDone(t,n)}},i=function(t,e,r){console.warn("update msater prefetch error: ".concat(r," (").concat(e,", ").concat(t,")"))};!function n(){e._updateMasterPlaylistHandler=setTimeout(function(){e._isDestroied||(e._lastFetchMasterM3u8Begin=performance.now(),e._prefetchM3u8(t,r,i,2e3,3),n())},e._masterPlaylistUpdateInterval)}()}},{key:"_doNextFetch",value:function(){var t=this,e=this._playlist,r=e.count,i=e.endOfStream;if(0===r&&i)this._pushEnd();else if(r>0&&(i||this._totalDuration<4e3||e.remainDuration>this._minBufferLength))this._fetchNextM4s();else{void 0!==this._fetchM3u8Timer&&(window.clearTimeout(this._fetchM3u8Timer),this._fetchM3u8Timer=void 0);var n=performance.now()-this._lastFetchM3u8,a=Math.round(this._lastDuration-n);this._tryM3u8Times=0,(a<0||a<100)&&(a=0),this._fetchM3u8Timer=window.setTimeout(this._fetchM3u8Binder,a),this._targetSwitchPlaylistUrl&&(this._trySwitchPlaylistCount<this._trySwitchPlaylistMaxCount?(this._trySwitchPlaylistCount++,void 0!==this._fetchSwitchPlaylistTimer&&window.clearTimeout(this._fetchSwitchPlaylistTimer),this._fetchSwitchPlaylistTimer=window.setTimeout(function(){t._fetchSwitchPlaylistTimer=void 0,t._updateTargetPlaylist(t._targetSwitchPlaylistUrl)},a/2)):(this._targetSwitchPlaylistUrl=null,this._paddingSwitchPlaylistResolve(u.errorSwitchTimeNotMatch)))}}},{key:"_prefetchM3u8",value:function(t,e,r,i,n){var a=this,o=0,s=new h(function(t,e){return!a._isDestroied&&!!e.ok},e,function(t,e,i){e===u.errorNetworkTimeout&&!a._isDestroied&&++o<n?(console.warn("prefetch ".concat(o,": ").concat(t," after 2s timeout")),l()):r(t,e,i)}),l=function(){try{s.fetchAsText(t,!1,i)}catch(e){r(t,u.errorNetworkFetch,e)}};l()}},{key:"_fetchM3u8",value:function(){try{this._lastFetchM3u8Begin=this._lastFetchM3u8=performance.now(),this._lastFetchM3u8End=null,this._m3u8Fetcher.fetchAsText(this._url,!1,2e3)}catch(t){this._notifyNetworkError(u.errorNetworkFetch,{url:this._url,info:t})}}},{key:"_fetchNextM4s",value:function(){var t=null;try{var e=this._playlist.shift();e&&(t=e.uri,this._lastDuration=Math.floor(1e3*e.duration),this._lastFetchM4sUrl=t,this._lastFetchM4sBegin=performance.now(),this._lastFetchM4sEnd=null,this._m4sFetcher.fetchAsStream(t,!1,this._timeout))}catch(e){this._notifyNetworkError(u.errorNetworkFetch,{url:t,info:e})}this._removeOutdated()}},{key:"_onM3u8Responsed",value:function(t,e){return!(this._isDestroied||(304===e.status?(this._isDestroied||this._doNextFetch(),1):e.ok?(!this._firstResponseNotified&&this.onFirstResponse&&(this._firstResponseNotified=!0,this.onFirstResponse(e)),0):(this._playlist&&(this._playlist.endOfStream=!0),this._notifyNetworkError(u.errorNetworkFetch,{url:t,status:e.status}),1)))}},{key:"_onM3u8Fetched",value:function(t,e,r){var i=performance.now(),n=i-this._lastFetchM3u8Begin;this._lastFetchM3u8Begin=null,this._lastFetchM3u8End=i;var a=this._playlist;if(e&&a){if(t!=this._url)return void this._fetchM3u8();var o=a.parse(e);if(o==f.parsedAsMaster)return this._url=this._masterPlaylistProcessor(a.streamUrls,a.streamInfMaps,a.steering),console.log("stream url: ".concat(this._url)),a.setUrl(this._url),this._fetchM3u8(),void this._initMasterPlaylistUpdater(t);if(o<0&&0===a.count)return void this._notifyParserError(u.errorM3u8Data,{url:t,info:o});if(this._lastM3u8Sequence!==a.lastSequence)this._lastM3u8Sequence=a.lastSequence,this._lastM3u8Updated=i;else if(i>=this._lastM3u8Updated+this._timeout)return void this._notifyParserError(u.errorM3u8NotUpdate,{url:t,info:Math.round(i-this._lastM3u8Updated)})}if(a&&a.count>0&&!this._initDone){var s=a.shift();try{this._lastFetchInitM4sBegin=performance.now(),new h(this._onM4sResponsedBinder,this._onInitM4sFetched.bind(this),this._onM4sFetchErrorBinder).fetchAsBuffer(s.uri)}catch(t){this._notifyNetworkError(u.errorNetworkFetch,{url:s?s.uri:null,info:t})}}this._isDestroied||(this._doNextFetch(),this._onUrlFetchDone(t,n))}},{key:"_onM3u8FetchError",value:function(t,e,r){e===u.errorNetworkTimeout&&!this._isDestroied&&++this._tryM3u8Times<3?(console.warn("fetch ".concat(this._tryM3u8Times,": ").concat(t," after 1s timeout")),this._fetchM3u8()):this._notifyNetworkError(e,{url:t,info:r})}},{key:"_onM4sResponsed",value:function(t,e){return!(this._isDestroied||!e.ok&&(this._notifyNetworkError(u.errorNetworkFetch,{url:t,status:e.status}),1))}},{key:"_onInitM4sFetched",value:function(t,e,r){var i=performance.now()-this._lastFetchInitM4sBegin;this._lastFetchInitM4sBegin=null,e&&(this._parseM4s(t,e,r),this._receivedBytes+=e.byteLength),r&&(this._initDone=!0,this._fetchedM4sCount++,this._onUrlFetchDone(t,i))}},{key:"_onM4sFetched",value:function(t,e,r){if(!this._isDestroied){!this._firstPacketNotified&&this.onFirstPacket&&(this._firstPacketNotified=!0,this.onFirstPacket());var i=performance.now(),n=i-this._lastFetchM4sBegin;if(r&&(this._lastFetchM4sBegin=null,this._lastFetchM4sEnd=i,this._totalDuration+=this._lastDuration,this._doNextFetch()),e){var a=this._pendingBuffers;if(this._initDone){for(;a.length>0;){var o=a.shift();this._parseM4s(o.url,o.buffer,o.done)}this._parseM4s(t,e,r)}else a.push({url:t,buffer:e,done:r});this._receivedBytes+=e.byteLength}r&&(this._fetchedM4sCount++,this._onUrlFetchDone(t,n,this._lastDuration))}}},{key:"_onM4sFetchError",value:function(t,e,r){this._notifyNetworkError(e,{url:t,info:r})}},{key:"_onM4sParsed",value:function(t,e){var r=this._mp4Parser;1836019574===e&&r&&r.metaData&&(this._mimeType=r.mimeType,this.onMetaData&&this.onMetaData(r.metaData)),r&&this._ensureMse(r.mimeType),this._pushBuffer(t)}},{key:"_onUrlFetchDone",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;this.onFileFetched&&this.onFileFetched(t,{used:Math.round(e),duration:r})}},{key:"_parseM4s",value:function(t,e,r){try{this._mp4Parser&&this._mp4Parser.parse(e,r)}catch(e){var i="DtsError"===e.name?u.errorMp4Dts:u.errorMp4Data;this._notifyParserError(i,{url:t,info:e.message})}}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===i(a)?a:String(a)),n)}var a}(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),y}(l.LivePlayer);t.exports.m=d},690:(t,e,r)=>{function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n=r(483).E,a=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._mediaSource=e,this._player=r,this._url=null,this._isOpened=!1,this._isDestroied=!1,this._mimeType=null,this._mseController=null,this._keepUsedBuffer=10,this._timeout=0,this._masterPlaylistUpdateInterval=1e4,this._lastRemovedPos=0,this._firstResponseNotified=!1,this._firstPacketNotified=!1,this._receivedBytes=0,this.startTime=0,this.onFirstResponse=null,this.onFirstPacket=null,this.onMetaData=null,this.onSeiData=null,this.onEndOfStream=null,this.onFileFetched=null,this.onNetworkError=null,this.onParserError=null,this.onMasterPlaylistUpdate=null}var e,r;return e=t,(r=[{key:"destroy",value:function(){this._isDestroied||(this._isDestroied=!0,this._player.src&&URL.revokeObjectURL(this._player.src)),this._mseController&&(this._mseController.destroy(),this._mseController=null),this._isOpened=!1,this._lastRemovedPos=0,this._mimeType=null,this._firstResponseNotified=!1,this._firstPacketNotified=!1,this._receivedBytes=0}},{key:"version",get:function(){}},{key:"buffered",get:function(){var t=this._player.buffered;return t&&t.length>0?t.end(t.length-1)-this._player.currentTime:0}},{key:"mimeType",get:function(){return this._mimeType}},{key:"receivedBytes",get:function(){return this._receivedBytes}},{key:"keepUsedBuffer",set:function(t){this._keepUsedBuffer=t}},{key:"timeout",set:function(t){this._timeout=t}},{key:"masterPlaylistUpdateInterval",set:function(t){this._masterPlaylistUpdateInterval=t}},{key:"_notifyNetworkError",value:function(t,e){this.onNetworkError&&!this._isDestroied&&this.onNetworkError(t,e)}},{key:"_notifyParserError",value:function(t,e){this.onParserError&&!this._isDestroied&&this.onParserError(t,e)}},{key:"_onMseError",value:function(t,e){this._notifyParserError(t,{url:this._url,info:e})}},{key:"_setup",value:function(t){this._mseController&&this._mseController.destroy(),this._mseController=new n(this._mediaSource,this.onEndOfStream,this._onMseError.bind(this)),this._lastRemovedPos=0,this._receivedBytes=0,this._isDestroied=!1,this._url=t,this._mediaSource&&(this._mediaSource.createObjectURL?this._player.src=this._mediaSource.createObjectURL(this._player):this._player.src=URL.createObjectURL(this._mediaSource))}},{key:"_ensureMse",value:function(t){this._mimeType=t,t&&!this._isOpened&&this._mseController&&(this._isOpened=this._mseController.addSource(t))}},{key:"_pushBuffer",value:function(t){this._mseController&&this._mseController.pushBuffer(t)}},{key:"_pushEnd",value:function(){this._mseController&&this._mseController.pushEnd()}},{key:"_removeOutdated",value:function(){var t=this._player.currentTime;if(t>this._lastRemovedPos+this._keepUsedBuffer+10){var e=this._lastRemovedPos>10?this._lastRemovedPos-10:0,r=Math.floor(t-this._keepUsedBuffer);this._mseController&&this._mseController.removeBuffer(e,r)&&(this._lastRemovedPos=r)}}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===i(a)?a:String(a)),n)}var a}(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.exports.LivePlayer=a},35:(t,e,r)=>{var i=r(221).checkChromeVer,n=r(704)._,a=r(809).R,o=r(521).m,s=r(313).V;t.exports={checkChromeVer:i,BufferDetector:n,fMp4Player:a,Hls7Player:o,NativePlayer:s}},118:(t,e,r)=>{function i(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){u=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function s(t,e){for(var r=0;r<e.length;r++){var i=e[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,(n=function(t,e){if("object"!==a(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var i=r.call(t,"string");if("object"!==a(i))return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(i.key),"symbol"===a(n)?n:String(n)),i)}var n}function u(t,e,r){return e&&s(t.prototype,e),r&&s(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var l=r(958),h=r(319),c=r(541),f=r(274),d=r(221),_=r(757),y=r(497).$,p=r(754).Av1Parser,v=function(){function t(e,r,i){o(this,t),this.type=e,this.id=r,this.tag=i,this.baseMediaDecodeTime=0,this.extraData=null,this.dataOffset=0,this.duration=0,this.samples=[],this.sequenceDts=null,this.timestampOffset=0,this.totalDuration=0,this.totalSampleCount=0,this.audioInfo=null,this.objectType=0,this.defaultDuration=0,this.maxGapDuration=0,this.videoInfo=null,this.averageDuration=0}return u(t,[{key:"timeScale",get:function(){return null!==this.audioInfo?this.audioInfo.rate:9e4}},{key:"channelCount",get:function(){return null!==this.audioInfo?this.audioInfo.channel:null}},{key:"sampleRate",get:function(){return null!==this.audioInfo?this.audioInfo.rate:null}},{key:"sampleBits",get:function(){return 16}},{key:"width",get:function(){return null!==this.videoInfo?this.videoInfo.width:null}},{key:"height",get:function(){return null!==this.videoInfo?this.videoInfo.height:null}}]),t}(),m=function(){function t(e,r,i,n,a){o(this,t);var s=d.checkChromeVer();this._chrome4x=s>0&&s<=49,this._audioTrackIndex=-1,this._videoTrackIndex=-1,this._lastSegmentDts=0,this._mdatSize=0,this._metaChanged=0,this._metaData={},this._nextTrackId=1,this._onMetaData=i,this._onSegment=r,this._onSeiData=n,this._onError=a,this._parser=new c.FlvParser(this._onSampleReceived.bind(this),this._onMetaDataReceived.bind(this)),this._segmentIsGop=!0,this._segmentDuration=e,this._sequenceNumber=1,this._tracks=[],this._unknownTypes=new Set}return u(t,[{key:"destroy",value:function(){}},{key:"reset",value:function(){this._parser.clear(),this._lastSegmentDts=0,this._mdatSize=0,this._segmentIsGop=!0;var t,e=i(this._tracks);try{for(e.s();!(t=e.n()).done;){var r=t.value;r.samples.length=0,r.dataOffset=0,r.sequenceDts=null,r.timestampOffset=0,r.totalDuration=0,r.totalSampleCount=0}}catch(t){e.e(t)}finally{e.f()}}},{key:"input",value:function(t){try{this._parser.input(t)}catch(t){if(this._onError){var e="DtsError"===t.name?h.errorFlvDts:h.errorFlvPacket;this._onError(e,t.message)}}}},{key:"mimeType",get:function(){var t,e="",r=i(this._tracks);try{for(r.s();!(t=r.n()).done;){var n=t.value;null!==n.audioInfo?e+=n.audioInfo.codecs+",":null!==n.videoInfo&&(e+=n.videoInfo.codecs+",")}}catch(t){r.e(t)}finally{r.f()}for(;e.length>1&&","===e[e.length-1];)e=e.substring(0,e.length-1);return'video/mp4; codecs="'+e+'"'}},{key:"_addSample",value:function(t,e){t.samples.push(e),t.totalSampleCount++,this._mdatSize+=e.size}},{key:"_onAudioSample",value:function(e){var r=e.dts;if(-1===this._videoTrackIndex&&this._timeToOutput(!1,r)&&this._outputDataSegment(r),this._audioTrackIndex>=0&&this._audioTrackIndex<this._tracks.length){var i=this._tracks[this._audioTrackIndex];if(null===i.sequenceDts&&(i.sequenceDts=r),i.objectType===l.audioTypeAAC){var n=i.audioInfo.rate,a=t._millisecToAudioTs(r,i)-i.totalDuration;if(a>=i.maxGapDuration){var o=a/n;if(o>=30)throw new h.SomeError("DtsError","too large ".concat(o," underflow"));var s=Math.floor(a/i.defaultDuration);for(console.log("insert ".concat(s," frames due to ").concat(o," underflow"));s--;){var u=t._getSilentAacFrame(i,e.data);u.duration=i.defaultDuration,i.totalDuration+=u.duration,this._addSample(i,u)}}else if(a<=-i.maxGapDuration)return void console.log("skip 1 frame due to ".concat(-a/n," overflow"))}e.dts=i.totalDuration,e.duration=i.defaultDuration,i.totalDuration+=e.duration,this._addSample(i,e)}else console.warn("invalid audio track: ".concat(this._audioTrackIndex))}},{key:"_onVideoSample",value:function(e){var r=this,i=e.dts,n=1===e.flags;if(this._timeToOutput(n,i)&&(this._outputDataSegment(i),this._segmentIsGop=n),this._videoTrackIndex>=0&&this._videoTrackIndex<this._tracks.length){var a=this._tracks[this._videoTrackIndex];if(null===a.sequenceDts&&(a.sequenceDts=i,0===a.totalSampleCount&&(e.cts=0),e.flags=1),e.cts=Math.floor(90*e.cts),e.dts=t._millisecToVideoTs(i,a),a.samples.length>0){var o=a.samples[a.samples.length-1];o.duration=e.dts>o.dts?e.dts-o.dts:0}a.totalDuration=e.dts,a.totalSampleCount>0&&(a.averageDuration=Math.floor(a.totalDuration/a.totalSampleCount));var s=e.dts/9e4,u=e.cts/9e4;if(e.type===c.typeVideoH264||e.type===c.typeVideoH265)this._parseSeiData(e.data,e.size,s,u,a.videoInfo.nalu,e.type===c.typeVideoH265);else if(e.type===c.typeVideoAv1){var l=new p;l.onCustomData=function(t,e){r._onSeiData&&r._onSeiData(s,s+u,t,e)},l.parseObus(e.data)}this._addSample(a,e)}else console.warn("invalid video track: ".concat(this._videoTrackIndex))}},{key:"_onAudioTrack",value:function(e){var r=e.type===c.trackAudioAAC,i=r?l.audioTypeAAC:l.audioTypeMP3,n=l.parseAudioInfo(e.data,i);if(n){if(this._audioTrackIndex>=0&&this._audioTrackIndex<this._tracks.length){var a=this._tracks[this._audioTrackIndex];if(t._same_array(a.extraData,e.data))return;this._outputNow(),a.extraData=e.data,a.audioInfo=n,a.objectType=i,a.defaultDuration=n.frame,a.maxGapDuration=2*a.defaultDuration,t._resetTrackTimestamps(a)}else{var o=f.types.mp4a,s=new v("audio",this._nextTrackId++,o);s.extraData=r?e.data:null,s.audioInfo=n,s.objectType=i,s.defaultDuration=n.frame,s.maxGapDuration=2*s.defaultDuration,this._audioTrackIndex=this._tracks.length,this._tracks.push(s),this._outputNow()}this._metaData.audiosamplerate=n.rate,this._metaData.audiochannel=n.channel,this._metaChanged|=1}else this._onError&&this._onError(h.errorAudioInfo,"parse audio track failed")}},{key:"_onVideoTrack",value:function(e){var r=l.parseVideoInfo(e.data,e.type);if(r){if(this._videoTrackIndex>=0&&this._videoTrackIndex<this._tracks.length){var i=this._tracks[this._videoTrackIndex];if(t._same_array(i.extraData,e.data))return;this._outputNow(),i.extraData=e.data,i.videoInfo=r,t._fixLastVideoDuration(i,0),t._resetTrackTimestamps(i)}else{var n=void 0;switch(e.type){case c.trackVideoH264:n=f.types.avc1;break;case c.trackVideoH265:n=f.types.hvc1;break;case c.trackVideoAv1:n=f.types.av01}var a=new v("video",this._nextTrackId++,n);a.extraData=e.data,a.videoInfo=r,this._videoTrackIndex=this._tracks.length,this._tracks.push(a),this._outputNow()}this._metaData.width=r.width,this._metaData.height=r.height,this._metaData.fps||(this._metaData.fps=this._metaData.framerate),this._metaChanged|=2}else this._onError&&this._onError(h.errorVideoInfo,"parse video track failed")}},{key:"_onMetaDataReceived",value:function(t){if(t)for(var e in t)this._metaData[e]=t[e]}},{key:"_onSampleReceived",value:function(t){switch(t.type){case c.typeAudioAAC:this._onAudioSample(t);break;case c.typeVideoH264:case c.typeVideoH265:case c.typeVideoAv1:this._onVideoSample(t);break;case c.trackAudioAAC:case c.trackAudioMP3:this._onAudioTrack(t);break;case c.trackVideoH264:case c.trackVideoH265:case c.trackVideoAv1:this._onVideoTrack(t);break;default:this._unknownTypes.has(t.type)||(this._unknownTypes.add(t.type),this._onError&&this._onError(h.errorUnknownCodec,"unknown codec: ".concat(t.type)))}return!0}},{key:"_outputDataSegment",value:function(e){if(this._mdatSize&&this._metaChanged){this._onMetaData&&this._onMetaData(this._metaData),this._metaChanged=0;var r=f.initSegment(this._tracks);this._onSegment(r)}var n=this._tracks;if(this._mdatSize){var a=f.moofSize(n),o=8+this._mdatSize,s=new Uint8Array(a+o);s[a+0]=o>>>24&255,s[a+1]=o>>>16&255,s[a+2]=o>>>8&255,s[a+3]=255&o,s.set(f.types.mdat,a+4);var u,l=a+8,h=i(n);try{for(h.s();!(u=h.n()).done;){var c=u.value;c.samples.length>0&&("video"===c.type&&t._fixLastVideoDuration(c,e),this._chrome4x&&(c.samples[0].flags=1),c.baseMediaDecodeTime=c.samples[0].dts),c.dataOffset=l,l=t._concatenateSamplesData(c,s,l)}}catch(t){h.e(t)}finally{h.f()}var d=f.moof(this._sequenceNumber++,n);s.set(d),this._onSegment(s)}this._lastSegmentDts=e,this._mdatSize=0;var _,y=i(n);try{for(y.s();!(_=y.n()).done;){var p=_.value;p.samples.length=0,p.dataOffset=0}}catch(t){y.e(t)}finally{y.f()}}},{key:"_outputNow",value:function(){this._mdatSize>0&&this._outputDataSegment(this._lastSegmentDts)}},{key:"_parseSeiData",value:function(t,e,r,i,n,a){this._onSeiData&&y.parse(t,0,e,r,r+i,n,a,this._onSeiData)}},{key:"_timeToOutput",value:function(t,e){return!(!t||this._segmentIsGop)||e<this._lastSegmentDts||e>=this._lastSegmentDts+this._segmentDuration}}],[{key:"_same_array",value:function(t,e){var r=t?t.length:0;if(r!==(e?e.length:0))return!1;for(var i=0;i<r;i++)if(t[i]!==e[i])return!1;return!0}},{key:"_concatenateSamplesData",value:function(t,e,r){var n,a=i(t.samples);try{for(a.s();!(n=a.n()).done;){var o=n.value;e.set(o.data,r),r+=o.size}}catch(t){a.e(t)}finally{a.f()}return r}},{key:"_fixLastVideoDuration",value:function(e,r){if(e.samples.length>0){var i=e.samples[e.samples.length-1];0===i.duration&&(r=t._millisecToVideoTs(r,e),i.duration=r>i.dts?r-i.dts:e.averageDuration>0?e.averageDuration:1500,e.totalDuration+=i.duration)}}},{key:"_getSilentAacFrame",value:function(t,e){var r=_.getSilentFrame(t.audioInfo.profile,t.audioInfo.channel),i=t.totalDuration;return new c.Sample(c.typeAudioAAC,r||e,0,i,0)}},{key:"_millisecToAudioTs",value:function(t,e){return Math.floor((t-e.sequenceDts)*e.audioInfo.rate/1e3)+e.timestampOffset}},{key:"_millisecToVideoTs",value:function(t,e){return 90*(t-e.sequenceDts)+e.timestampOffset}},{key:"_resetTrackTimestamps",value:function(t){t.timestampOffset=t.totalDuration,t.sequenceDts=null}}]),t}();t.exports={fMp4Muxer:m}},274:t=>{function e(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return r(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?r(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){u=!0,o=t},f:function(){try{s||null==i.return||i.return()}finally{if(u)throw o}}}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}var i,n,a,o,s,u,l,h,c,f,d,_,y,p,v,m,b,g,k,w,S,B,P,T,M,x,D,U,E,A,O,I,C,F,j,R,N,L,q,V,H,z=Math.pow(2,32)-1;!function(){for(var t in S={avc1:[97,118,99,49],avcC:[97,118,99,67],av01:[97,118,48,49],av1C:[97,118,49,67],btrt:[98,116,114,116],dinf:[100,105,110,102],dref:[100,114,101,102],esds:[101,115,100,115],ftyp:[102,116,121,112],hdlr:[104,100,108,114],hvc1:[104,118,99,49],hvcC:[104,118,99,67],mdat:[109,100,97,116],mdhd:[109,100,104,100],mdia:[109,100,105,97],mfhd:[109,102,104,100],minf:[109,105,110,102],moof:[109,111,111,102],moov:[109,111,111,118],mp4a:[109,112,52,97],mvex:[109,118,101,120],mvhd:[109,118,104,100],pasp:[112,97,115,112],sdtp:[115,100,116,112],smhd:[115,109,104,100],stbl:[115,116,98,108],stco:[115,116,99,111],stsc:[115,116,115,99],stsd:[115,116,115,100],stss:[115,116,115,115],stsz:[115,116,115,122],stts:[115,116,116,115],styp:[115,116,121,112],tfdt:[116,102,100,116],tfhd:[116,102,104,100],traf:[116,114,97,102],trak:[116,114,97,107],trun:[116,114,117,110],trex:[116,114,101,120],tkhd:[116,107,104,100],vmhd:[118,109,104,100]})S[t]=new Uint8Array(S[t]);B=new Uint8Array([105,115,111,109]),T=new Uint8Array([97,118,99,49]),M=new Uint8Array([109,112,52,50]),x=new Uint8Array([100,97,115,104]),P=new Uint8Array([0,0,0,1]),D=new Uint8Array([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),U=new Uint8Array([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),E={video:D,audio:U},I=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),O=new Uint8Array([0,0,0,0,0,0,0,0]),C=new Uint8Array([0,0,0,0,0,0,0,0]),F=C,j=C,R=new Uint8Array([0,0,0,0,0,0,0,0,0,0,0,0]),N=C,A=new Uint8Array([0,0,0,1,0,0,0,0,0,0,0,0])}(),i=function(t){var e,r,i=Array.prototype.slice.call(arguments,1),n=0;for(e=0;e<i.length;e++)n+=i[e].byteLength;for((r=new Uint8Array(n+8))[0]=r.byteLength>>>24&255,r[1]=r.byteLength>>>16&255,r[2]=r.byteLength>>>8&255,r[3]=255&r.byteLength,r.set(t,4),e=0,n=8;e<i.length;e++)r.set(i[e],n),n+=i[e].byteLength;return r},n=function(){return i(S.dinf,i(S.dref,I))},a=function(t){var e=t.extraData?t.extraData.length:0,r=13+(e>0?e+5:0),n=8+r+5+1,a=new Uint8Array([0,0,0,0,3,128|n>>>21,128|n>>>14,128|n>>>7,127&n,0,1,0,4,128|r>>>21,128|r>>>14,128|r>>>7,127&r,t.objectType,21,0,0,0,0,1,89,40,0,1,89,40]),o=0===e?null:new Uint8Array([5,128|e>>>21,128|e>>>14,128|e>>>7,127&e]),s=new Uint8Array([6,128,128,128,1,2]);return e>0?i(S.esds,a,o,t.extraData,s):i(S.esds,a,s)},o=function(){return i(S.ftyp,B,P,B,M,T,x)},v=function(t){return i(S.hdlr,E[t])},p=function(t){var e=new Uint8Array([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,t.duration>>>24&255,t.duration>>>16&255,t.duration>>>8&255,255&t.duration,85,196,0,0]);return t.sampleRate&&(e[12]=t.sampleRate>>>24&255,e[13]=t.sampleRate>>>16&255,e[14]=t.sampleRate>>>8&255,e[15]=255&t.sampleRate),i(S.mdhd,e)},y=function(t){return i(S.mdia,p(t),v(t.type),u(t))},s=function(t){return i(S.mfhd,new Uint8Array([0,0,0,0,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t]))},u=function(t){return i(S.minf,"video"===t.type?i(S.vmhd,A):i(S.smhd,O),n(),m(t))},q=function(t){var r=8;r+=16;var i,n=e(t);try{for(n.s();!(i=n.n()).done;){var a=i.value,o=a.samples.length;o>0&&(r+=8,r+=8+(a.defaultDuration?4:0)+16,r+=20,r+=24+o*(a.defaultDuration?4:12))}}catch(t){n.e(t)}finally{n.f()}return r},l=function(t,r){var n=[S.moof];n.push(s(t));var a,o=e(r);try{for(o.s();!(a=o.n()).done;){var u=a.value;u.samples.length>0&&n.push(g(u,0))}}catch(t){o.e(t)}finally{o.f()}return i.apply(null,n)},h=function(t){var r=[S.moov];r.push(f(t.length+1,0));var n,a=e(t);try{for(a.s();!(n=a.n()).done;){var o=n.value;r.push(d(o))}}catch(t){a.e(t)}finally{a.f()}return r.push(c(t)),i.apply(null,r)},c=function(t){var r,n=[S.mvex],a=e(t);try{for(a.s();!(r=a.n()).done;){var o=r.value;n.push(k(o))}}catch(t){a.e(t)}finally{a.f()}return i.apply(null,n)},f=function(t,e){var r=new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&e)>>24,(16711680&e)>>16,(65280&e)>>8,255&e,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(4278190080&t)>>24,(16711680&t)>>16,(65280&t)>>8,255&t]);return i(S.mvhd,r)},m=function(t){return"video"===t.type?i(S.stbl,b(t),i(S.stts,N),i(S.stss,j),i(S.stsc,F),i(S.stsz,R),i(S.stco,C)):i(S.stbl,b(t),i(S.stts,N),i(S.stsc,F),i(S.stsz,R),i(S.stco,C))},b=function(t){return i(S.stsd,new Uint8Array([0,0,0,0,0,0,0,1]),"video"===t.type?V(t):H(t))},V=function(t){var e=S.avcC;switch(t.tag){case S.avc1:e=S.avcC;break;case S.hvc1:e=S.hvcC;break;case S.av01:e=S.av1C}var r=[t.tag,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&t.width)>>8,255&t.width,(65280&t.height)>>8,255&t.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,24,255,255]),i(e,t.extraData)];if(t.sarRatio){var n=t.sarRatio[0],a=t.sarRatio[1];r.push(i(S.pasp,new Uint8Array([(4278190080&n)>>24,(16711680&n)>>16,(65280&n)>>8,255&n,(4278190080&a)>>24,(16711680&a)>>16,(65280&a)>>8,255&a])))}return i.apply(null,r)},H=function(t){return i(t.tag,new Uint8Array([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&t.channelCount)>>8,255&t.channelCount,(65280&t.sampleBits)>>8,255&t.sampleBits,0,0,0,0,(65280&t.sampleRate)>>8,255&t.sampleRate,0,0]),a(t))},_=function(t){var e=new Uint8Array([0,0,0,3,0,0,0,0,0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,0,(4278190080&t.duration)>>24,(16711680&t.duration)>>16,(65280&t.duration)>>8,255&t.duration,0,0,0,0,0,0,0,0,0,0,0,0,"audio"===t.type?1:0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&t.width)>>8,255&t.width,0,0,(65280&t.height)>>8,255&t.height,0,0]);return i(S.tkhd,e)},g=function(t,e){var r,n,a,o,s,u=t.defaultDuration,l=u?131114:131106,h="audio"===t.type?33554432:16842752;return r=i(S.tfhd,new Uint8Array(u?[0,(16711680&l)>>16,(65280&l)>>8,255&l,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,(4278190080&u)>>24,(16711680&u)>>16,(65280&u)>>8,255&u,h>>>24&255,h>>>16&255,h>>>8&255,255&h]:[0,(16711680&l)>>16,(65280&l)>>8,255&l,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,h>>>24&255,h>>>16&255,h>>>8&255,255&h])),o=Math.floor(t.baseMediaDecodeTime/(z+1)),s=Math.floor(t.baseMediaDecodeTime%(z+1)),n=i(S.tfdt,new Uint8Array([1,0,0,0,o>>>24&255,o>>>16&255,o>>>8&255,255&o,s>>>24&255,s>>>16&255,s>>>8&255,255&s])),a=w(t,e),i(S.traf,r,n,a)},d=function(t){return i(S.trak,_(t),y(t))},k=function(t){var e=new Uint8Array([0,0,0,0,(4278190080&t.id)>>24,(16711680&t.id)>>16,(65280&t.id)>>8,255&t.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0]);return i(S.trex,e)},w=function(t,e){var r=e+t.dataOffset,n=t.samples,a=n.length,o=t.defaultDuration,s=a>0&&1===n[0].flags,u=new Uint8Array(16+a*(o?4:12)),l=517;o||(l|=2304),u.set([1,(16711680&l)>>16,(65280&l)>>8,255&l,(4278190080&a)>>>24,(16711680&a)>>>16,(65280&a)>>>8,255&a,(4278190080&r)>>>24,(16711680&r)>>>16,(65280&r)>>>8,255&r],0);var h=12;if(u.set(s?[2,0,0,0]:[1,1,0,0],h),h+=4,o)for(var c=0;c<a;c++){var f=n[c].size;u.set([(4278190080&f)>>>24,(16711680&f)>>>16,(65280&f)>>>8,255&f],h),h+=4}else for(c=0;c<a;c++){var d=n[c],_=d.duration,y=d.size,p=d.cts;u.set([(4278190080&_)>>>24,(16711680&_)>>>16,(65280&_)>>>8,255&_,(4278190080&y)>>>24,(16711680&y)>>>16,(65280&y)>>>8,255&y,(4278190080&p)>>>24,(16711680&p)>>>16,(65280&p)>>>8,255&p],h),h+=12}return i(S.trun,u)},L=function(t){var e,r=o(),i=h(t);return(e=new Uint8Array(r.byteLength+i.byteLength)).set(r),e.set(i,r.byteLength),e},t.exports={moof:l,moov:h,types:S,initSegment:L,moofSize:q}},313:(t,e,r)=>{function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(){return(n="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,r){var i=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=o(t)););return t}(t,e);if(i){var n=Object.getOwnPropertyDescriptor(i,e);return n.get?n.get.call(arguments.length<3?t:r):n.value}}).apply(this,arguments)}function a(t,e){return(a=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function o(t){return(o=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var s=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&a(t,e)}(h,t);var e,r,s,u,l=(s=h,u=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}(),function(){var t,e=o(s);if(u){var r=o(this).constructor;t=Reflect.construct(e,arguments,r)}else t=e.apply(this,arguments);return function(t,e){if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}(this,t)});function h(t,e){var r;return function(t,e){if(!(t instanceof h))throw new TypeError("Cannot call a class as a function")}(this),r=l.call(this,t,e),console.log("NativePlayer ".concat(r.version)),r}return e=h,(r=[{key:"version",get:function(){return"v1.0"}},{key:"destroy",value:function(){n(o(h.prototype),"destroy",this).call(this)}},{key:"src",set:function(t){this.destroy(),this._player.src=t,0!==this.startTime&&(this._player.currentTime=this.startTime)}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===i(a)?a:String(a)),n)}var a}(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),h}(r(690).LivePlayer);t.exports.V=s},443:t=>{function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,r){for(var i=0;i<r.length;i++){var n=r[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=function(t,r){if("object"!==e(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!==e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===e(a)?a:String(a)),n)}var a}function i(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=i(function t(e,r,i,a){n(this,t),this.name=e,this.value=r,this.offset=i,this.end=a}),o=function(){function t(){n(this,t);try{this._textDecoder=new TextDecoder}catch(t){this._textDecoder=null,this._fromChar=String.fromCodePoint?String.fromCodePoint:String.fromCharCode}}return i(t,[{key:"decodeUtf8",value:function(t){if(this._textDecoder){var e=t.indexOf(0);return-1!==e&&(t=t.subarray(0,e)),this._textDecoder.decode(t)}for(var r=t.length,i="",n=0;n<r;){var a=t[n++];if(0===a)break;var o=0;switch(a>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:o=a;break;case 12:case 13:o=(31&a)<<6|63&t[n++];break;case 14:o=(15&a)<<12|(63&t[n++])<<6|(63&t[n++])<<0;break;case 15:o=(7&a)<<18|(63&t[n++])<<12|(63&t[n++])<<6|63&t[n++]}0!==o&&(i+=this._fromChar(o))}return i}},{key:"parse",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;for(r||(r=t.byteLength-1);e<r;)try{var i=this._parseValue(t,null,e),n=this._parseValue(t,i,i.offset);if(e=n.offset,"onMetaData"===i.value)return n.value}catch(t){console.warn("parse failed",t);break}return null}},{key:"_parseValue",value:function(t,e,r){var i,n=t.getUint8(r++),o=!1;switch(n){case 0:i=t.getFloat64(r),r+=8;break;case 1:i=!!t.getUint8(r),r+=1;break;case 2:case 12:var s=this._parseArray(t,r,12===n);r+=2+s.length,i=this.decodeUtf8(s);break;case 3:i={},r=this._parseObjects(t,r,65535,i);break;case 8:var u=t.getUint32(r);r+=4,i={},r=this._parseObjects(t,r,u,i);break;case 9:i=null,o=!0;break;case 10:var l=t.byteLength-1,h=t.getUint32(r);for(r+=4,i=[];h-- >0&&r<l;){var c=this._parseValue(t,null,r);r=c.offset,i.push(c.value)}break;case 11:i=this._parseDate(t,r),r+=10}return new a(e,i,r,o)}},{key:"_parseArray",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]&&arguments[2],i=r?t.getUint32(e):t.getUint16(e);return new Uint8Array(t.buffer,t.byteOffset+e+(r?4:2),i)}},{key:"_parseDate",value:function(t,e){var r=t.getFloat64(e),i=t.getInt16(e+8);return new Date(r+=60*i*1e3)}},{key:"_parseObject",value:function(t,e){var r=this._parseArray(t,e);e+=2+r.length;var i=this.decodeUtf8(r);return this._parseValue(t,i,e)}},{key:"_parseObjects",value:function(t,e,r,i){for(var n=t.byteLength-1;r-- >0&&e<n;){var a=this._parseObject(t,e);if(e=a.offset,a.end)break;i[a.name]=a.value}return e}}]),t}();t.exports.l=o},541:(t,e,r)=>{function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===i(a)?a:String(a)),n)}var a}function a(t,e,r){return e&&n(t.prototype,e),r&&n(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function o(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var s=r(443).l,u=a(function t(e,r,i,n,a){o(this,t),this.type=e,this.data=r,this.cts=i,this.dts=n,this.duration=0,this.size=r.length,this.flags=a}),l=function(){function t(e,r){o(this,t),this._buffer=new Uint8Array(2097152),this._readPos=0,this._writePos=0,this._onSampleParsed=e,this._onMetaDataParsed=r}return a(t,[{key:"clear",value:function(){this._readPos=0,this._writePos=0}},{key:"input",value:function(t){for(this._writeToBuffer(t);this._parsePacket(););}},{key:"_parseHeader",value:function(){var e=this._writePos-this._readPos;if(e<9)return!1;var r=t._readUint32(this._buffer,this._readPos+5)+4;return!(e<r||(this._readPos+=r,0))}},{key:"_parsePacket",value:function(){var t=this._readPos,e=this._writePos-t;if(e<11)return!1;var r=this._buffer,i=r[t],n=r[t+1]<<16|r[t+2]<<8|r[t+3];if(5002753===n&&70===i)return this._parseHeader();if(n<=0||n>=12582912)throw new RangeError("invalid data size: ".concat(n));var a=11+n+4;if(e<a)return!1;this._readPos+=a;var o=r[t+4]<<16|r[t+5]<<8|r[t+6]|r[t+7]<<24,s=t+11,u=!0;switch(31&i){case 8:u=this._parseAudio(s,n,o);break;case 9:u=this._parseVideo(s,n,o);break;case 18:u=this._parseScript(s,n)}return u}},{key:"_parseAudio",value:function(t,e,r){var i=this._buffer,n=(240&i[t])>>>4;if(10===n){var a=0===i[t+1]?-n:n,o=new u(a,i.subarray(t+2,t+e),0,r,0);return this._onSampleParsed(o)}var s=new u(n,i.subarray(t+1,t+e),0,r,0);return this._onSampleParsed(s)}},{key:"_parseVideo",value:function(t,e,r){var i=this._buffer,n=(240&i[t])>>>4,a=15&i[t];if(7===a||12===a||14===a){var o=0===i[t+1]?-a:a,s=i[t+2]<<16|i[t+3]<<8|i[t+4];s=s<<8>>8;var l=new u(o,i.subarray(t+5,t+e),s,r,n);return this._onSampleParsed(l)}var h=new u(a,i.subarray(t+1,t+e),0,r,n);return this._onSampleParsed(h)}},{key:"_parseScript",value:function(t,e){var r=new DataView(this._buffer.buffer,t,e),i=(new s).parse(r);return this._onMetaDataParsed(i),!0}},{key:"_writeToBuffer",value:function(t){var e=t.length;if(this._writePos+e>this._buffer.length){var r=this._writePos-this._readPos,i=Math.max(this._buffer.length,r+2*e),n=new Uint8Array(i);n.set(this._buffer.subarray(this._readPos,this._writePos)),this._buffer=n,this._readPos=0,this._writePos=r}this._buffer.set(t,this._writePos),this._writePos+=e}}],[{key:"_readUint32",value:function(t,e){return t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3]}}]),t}();t.exports={typeAudioAAC:10,typeAudioMP3:2,typeVideoH264:7,typeVideoH265:12,typeVideoAv1:14,trackAudioAAC:-10,trackAudioMP3:-2,trackVideoH264:-7,trackVideoH265:-12,trackVideoAv1:-14},t.exports.Sample=u,t.exports.FlvParser=l},909:(t,e,r)=>{function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===i(a)?a:String(a)),n)}var a}var o=r(443).l,s=r(958),u=r(319),l=r(221),h=r(757),c=r(497).$,f=r(754).Av1Parser,d=r(41),_=function(){function t(e,r){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var i=l.checkChromeVer();this._chrome4x=i>0&&i<=49,this.uint32_max=Math.pow(2,32),this.mimeType=null,this.metaData={},this._audioChannel=void 0,this._audioRate=void 0,this._audioCodec=null,this._videoWidth=void 0,this._videoHeight=void 0,this._videoCodec=null,this._videoTag=0,this._videoBaseDts=0,this._videoCtsFixed=!1,this._videoTrackId=void 0,this._videoFrames=[],this._lastMoofSize=void 0,this._lastTrackId=void 0,this._findingStartDts=!1,this._minStartDts=void 0,this._timeScaleMap=new Map,this._buffer=null,this._bytesInBuffer=0,this._onParsed=e,this._onSeiParsed=r,this._parseMoofBoxsBinder=this._parseMoofBoxs.bind(this),this._parseMoovBoxsBinder=this._parseMoovBoxs.bind(this),this._lastFmp4Track=null,this._lastFmp4TrackFragment=null,this._tracks=new Map,this._trackInfos=new Map,this._trackFragments=new Map,this._selectedAudioTrackId=void 0,this._defaultAudioTrackId=void 0,this._segContext=void 0,this._prevSegContext=void 0}var e,r,i;return e=t,i=[{key:"parseEncoder",value:function(t,e){var r=e,i=e+32;t.getUint8(e)<32&&(r++,i--);var n=new Uint8Array(t.buffer,t.byteOffset,t.byteLength).subarray(r,i);return(new o).decodeUtf8(n)}},{key:"parseH264Codec",value:function(t,e){e+=8;var r=t.getUint8(e+1),i=t.getUint8(e+2),n=t.getUint8(e+3);return"avc1."+h.to02xString(r)+h.to02xString(i)+h.to02xString(n)}},{key:"parseH265Codec",value:function(t,e){e+=8;var r=t.getUint8(e+1),i=r>>6&3,n=r>>5&1,a=31&r,o=t.getUint32(e+2),s=t.getUint8(e+12),u=o;return u=(u=(u=(u=(u=u>>>1&1431655765|(1431655765&u)<<1)>>>2&858993459|(858993459&u)<<2)>>>4&252645135|(252645135&u)<<4)>>>8&16711935|(16711935&u)<<8)>>>16|u<<16,"hvc1."+["","A","B","C"][i%4]+a.toString()+"."+u.toString(16).toLowerCase()+"."+["L","H"][n%2]+s.toString()}},{key:"parseAV1Codec",value:function(t,e){e+=8;var r,i=t.getUint8(e+1),n=t.getUint8(e+2),a=i>>>5,o=31&i,s=n>>>7,u=n>>>6&1;return r=2===a&&u?n>>>5&1?12:10:u?10:8,"av01."+a+"."+h.to02uString(o)+(s?"H":"M")+"."+h.to02uString(r)}}],(r=[{key:"getAudioTracks",value:function(){var t=this,e=[];return this._tracks.forEach(function(r,i){"soun"===r.handler&&e.push({enabled:t._selectedAudioTrackId===r.trackId,id:r.trackId,kind:r.isDefault?"main":"",label:r.label,language:r.language,default:t._defaultAudioTrackId===r.trackId})}),e}},{key:"switchAudioTrack",value:function(t){var e;return"soun"===(null===(e=this._tracks.get(t))||void 0===e?void 0:e.handler)&&(this._selectedAudioTrackId=t,!0)}},{key:"clear",value:function(){this._buffer=null,this._bytesInBuffer=0}},{key:"parse",value:function(t,e){var r=this,i=0!==this._bytesInBuffer;i&&(this._appendBuffer(new Uint8Array(t)),t=this._buffer.subarray(0,this._bytesInBuffer));for(var n=new Uint8Array(t),a=new DataView(n.buffer),o=n.byteLength,s=0;s+8<=o;){var u=a.getUint32(s),l=s+u;if(l>o)break;var h=a.getUint32(s+4),c=n.subarray(s,l);switch(h){case 1836019558:if(this._prevSegContext=this._segContext,this._segContext={},this._lastMoofSize=u,void 0===this._minStartDts&&(this._findingStartDts=!0,this._parseBox(a,s,l,this._parseMoofBoxsBinder),this._findingStartDts=!1),this._lastTrackId=void 0,this._videoFrames.length=0,i)this._parseBox(a,s,l,this._parseMoofBoxsBinder);else{var f=new Uint8Array(c);this._parseBox(new DataView(f.buffer),0,u,this._parseMoofBoxsBinder),c=f}break;case 1836019574:if(this.metaData={},this._lastTrackId=void 0,this._parseBox(a,s,l,this._parseMoovBoxsBinder)){var d=void 0,_=void 0;this._tracks.forEach(function(t,e){"soun"===t.handler&&(void 0===d&&(d=t.trackId),void 0===_&&!0===t.isDefault&&(_=t.trackId))});var y=d;void 0!==_&&(y=_),this._defaultAudioTrackId=y,this._selectedAudioTrackId=y,this._tracks.forEach(function(t,e){"soun"===t.handler&&r._defaultAudioTrackId!==t.trackId&&r._changeBoxTag(a,t.trakBoxOffset,1718773093)}),this._updateMediaInfo(),this._updateMimeType()}break;case 1835295092:this._videoFrames.length&&(this._parseMdatBox(c,u),this._videoFrames.length=0)}this._onParsed(c,h),s=l}i&&0===s||(s>=o?this._bytesInBuffer=0:(this._bytesInBuffer=0,!e&&s<o&&this._appendBuffer(n.subarray(s))))}},{key:"_changeBoxTag",value:function(t,e,r){t.setUint32(e+4,r)}},{key:"_appendBuffer",value:function(t){var e=this._bytesInBuffer+t.length,r=new Uint8Array(e);this._buffer&&this._bytesInBuffer&&r.set(this._buffer.subarray(0,this._bytesInBuffer),0),this._buffer=r,this._buffer.set(t,this._bytesInBuffer),this._bytesInBuffer=e}},{key:"_parseMoovBoxs",value:function(t,e,r,i){switch(r){case 1836019574:case 1953653099:case 1835297121:case 1835626086:case 1937007212:return 1953653099===r&&(this._lastFmp4Track=new d.fMp4Track(e)),this._parseBox(t,e+8,e+i,this._parseMoovBoxsBinder);case 1937011556:this._parseStsdBox(t,e,i);break;case 1835296868:this._parseMdhdBox(t,e,i);break;case 1751411826:this._parseHdlrBox(t,e,i);break;case 1953196132:this._parseTkhdBox(t,e,i);break;case 1970628964:this._parseUuidBox(t,e,i)}return!0}},{key:"_parseMoofBoxs",value:function(t,e,r,i){switch(r){case 1836019558:case 1953653094:return 1953653094===r&&(this._lastFmp4TrackFragment=new d.fMp4TrackFragment(e)),this._parseBox(t,e+8,e+i,this._parseMoofBoxsBinder);case 1952868452:var n,a=16777215&t.getUint32(e+8),o=e+8+4;this._lastTrackId=t.getUint32(o);var s={default_sample_duration:null,default_sample_size:null};e=o+4,1&a&&(e+=8),2&a&&(e+=4),8&a&&(s.default_sample_duration=t.getUint32(e),e+=4),16&a&&(s.default_sample_size=t.getUint32(e),e+=4),this._lastFmp4TrackFragment.trackId=this._lastTrackId,this._trackFragments.set(this._lastTrackId,this._lastFmp4TrackFragment),this._trackInfos.set(this._lastTrackId,s),"soun"===(null===(n=this._tracks.get(this._lastTrackId))||void 0===n?void 0:n.handler)&&(this._selectedAudioTrackId!==this._lastTrackId?this._changeBoxTag(t,this._lastFmp4TrackFragment.trafBoxOffset,1718773093):t.setUint32(o,this._defaultAudioTrackId));break;case 1952867444:this._parseTfdtBox(t,e,i);break;case 1953658222:this._parseTrunBox(t,e,i)}return!0}},{key:"_parseMdhdBox",value:function(t,e,r){e+=12,e+=8,this._timeScaleMap[this._lastTrackId]=t.getUint32(e),e+=8;var i=t.getUint16(e),n=String.fromCharCode(96+(i>>10),96+(i>>5&31),96+(31&i));this._lastFmp4Track.language=n}},{key:"_parseHdlrBox",value:function(t,e,r){var i=12;i+=4;var n=new Uint8Array(t.buffer,e+i,4),a=(new o).decodeUtf8(n),s="";if(r-(i+=16)>0){var u=new Uint8Array(t.buffer,e+i,r-i);s=(new o).decodeUtf8(u)}this._lastFmp4Track.handler=a,this._lastFmp4Track.label=s,this._tracks.has(this._lastTrackId)&&(this._tracks.clear(),this._defaultAudioTrackId=void 0,this._selectedAudioTrackId=void 0),this._tracks.set(this._lastFmp4Track.trackId,this._lastFmp4Track)}},{key:"_parseTkhdBox",value:function(t,e,r){var i=8,n=t.getUint32(e+i);this._lastFmp4Track.isDefault=0!=(1&n),i+=4,i+=8,this._lastTrackId=t.getUint32(e+i),this._lastFmp4Track.trackId=this._lastTrackId}},{key:"_parseUuidBox",value:function(t,e,r){var i=8,n=new Uint8Array(t.buffer,e+i,16),a=r-(i+=16),s=new Uint8Array(t.buffer,e+i,a),u=new Uint8Array([255,204,130,99,248,85,74,147,136,20,88,122,2,82,31,221]);if(h.equalsUuid(n,u)){var l=(new o).decodeUtf8(s);this.metaData.googlesphericalvideodata=l}}},{key:"_parseStsdBox",value:function(e,r,i){r+=12;var n=e.getUint32(r);if(r+=4,0!==n){e.getUint32(r),r+=4;var a=e.getUint32(r);r+=4;var o=0;switch(a){case 1635148593:case 1752589105:case 1635135537:this.metaData.fps=e.getUint32(r+16)/100,this.metaData.videodatarate=e.getUint32(r+20)/1e3,this._videoWidth=e.getUint16(r+24),this._videoHeight=e.getUint16(r+26),this.metaData.encoder=t.parseEncoder(e,r+42),r+=78,(o=e.getUint32(r))>=12?1635148593===a?this._videoCodec=t.parseH264Codec(e,r):1752589105===a?this._videoCodec=t.parseH265Codec(e,r):1635135537===a&&(this._videoCodec=t.parseAV1Codec(e,r)):1635148593===a?this._videoCodec="avc1.64002a":1752589105===a?this._videoCodec="hvc1.1.6.L93.90":1635135537===a&&(this._videoCodec="av01.0.09M.08"),this._videoTag=a,this._videoTrackId=this._lastTrackId;break;case 1836069985:this._audioChannel=e.getUint16(r+16),this._audioRate=e.getUint32(r+24)>>>16,r+=28,o=e.getUint32(r),this._audioCodec=o>=10?this._parseAudioCodec(e,r):"mp4a.40.2";break;case 1700998451:this._audioChannel=e.getUint16(r+16),this._audioRate=e.getUint32(r+24)>>>16,this._audioCodec="ec-3"}}}},{key:"_parseTfdtBox",value:function(t,e,r){e+=8;var i=t.getUint8(e);e+=4;var n=1===i?this.getUint64(t,e):t.getUint32(e);if(void 0!==this._lastTrackId){var a=this._timeScaleMap[this._lastTrackId];if(this._findingStartDts){var o=n/this._timeScaleMap[this._lastTrackId];return void((this._minStartDts>o||void 0===this._minStartDts)&&(this._minStartDts=o,console.log("track ".concat(this._lastTrackId," start dts: ").concat(o))))}var s=Math.floor(this._minStartDts*a),l=n-s;if(l<0)throw new u.SomeError("DtsError","wrong dts: ".concat(n,"<").concat(s," in track ").concat(this._lastTrackId));1===i?this.setUint64(t,e,l):t.setUint32(e,l),this._lastTrackId===this._videoTrackId&&(this._videoBaseDts=l)}}},{key:"_parseTrunBox",value:function(t,e,r){if(this._lastTrackId===this._videoTrackId){e+=8;var i=16777215&t.getUint32(e);this._chrome4x&&4&i&&t.setUint32(e+12,33554432),e+=4;var n=t.getUint32(e);if(e+=4,0!==n){if(!this._videoCtsFixed&&2048&i){var a=e;1&i&&(e+=4),4&i&&(e+=4),256&i&&(e+=4),512&i&&(e+=4),1024&i&&(e+=4),0!==t.getInt32(e)&&t.setInt32(e,0),this._videoCtsFixed=!0,e=a}if(this._onSeiParsed){var o=this._trackInfos.get(this._lastTrackId),s=0;if(1&i){s=t.getUint32(e)-this._lastMoofSize,e+=4,4&i&&(e+=4);for(var u=this._videoBaseDts,l=0;l<n;l++){var h=null!=o&&null!=o.default_sample_duration?o.default_sample_duration:null;256&i&&(h=t.getUint32(e),e+=4);var c=null!=o&&null!=o.default_sample_size?o.default_sample_size:null;if(512&i&&(c=t.getUint32(e),e+=4),null==h||null==c)break;1024&i&&(e+=4);var f=u;2048&i&&(f=t.getInt32(e),e+=4),this._videoFrames.push({duration:h,dts:u,cts:f,offset:s,size:c}),u+=h,s+=c}}}}}}},{key:"_parseMdatBox",value:function(t,e){var r,i=this,a=function(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return n(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?n(t,e):void 0}}(t))){r&&(t=r);var i=0,a=function(){};return{s:a,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){u=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}(this._videoFrames);try{var o=function(){if(s=r.value,!i._onSeiParsed||s.offset+s.size>e)return"break";u=1/((u=i._timeScaleMap[i._videoTrackId])||9e4);var n=s.dts*u,a=n+s.cts*u;if(1635135537===i._videoTag){var o=new f;o.onCustomData=function(t,e){i._onSeiParsed&&i._onSeiParsed(n,a,t,e)},o.parseObus(t.subarray(s.offset,s.offset+s.size))}else c.parse(t,s.offset,s.size,n,a,4,1752589105===i._videoTag,i._onSeiParsed)};for(a.s();!(r=a.n()).done;){var s,u;if("break"===o())break}}catch(t){a.e(t)}finally{a.f()}}},{key:"_parseAudioCodec",value:function(t,e){e+=8,e+=4,e+=8,e+=5;var r=t.getUint8(e);if(107==r||105==r)return"mp3";e+=9,this.metaData.audiodatarate=t.getUint32(e)/1e3,e+=4,e+=5;var i=t.getUint8(e)>>>3&31;return s.getAacCodec(r,i)}},{key:"_parseBox",value:function(t,e,r,i){for(;e+8<=r;){var n=t.getUint32(e),a=t.getUint32(e+4);if(e+n>r||!i(t,e,a,n))return!1;e+=n}return e<=r}},{key:"_updateMediaInfo",value:function(){void 0!==this._audioRate&&(this.metaData.audiosamplerate=this._audioRate),void 0!==this._audioChannel&&(this.metaData.audiochannel=this._audioChannel),void 0!==this._videoWidth&&(this.metaData.width=this._videoWidth),void 0!==this._videoHeight&&(this.metaData.height=this._videoHeight)}},{key:"_updateMimeType",value:function(){var t='video/mp4; codecs="';if(this._audioCodec&&this._videoCodec)t+=this._videoCodec+","+this._audioCodec;else if(this._audioCodec)t+=this._audioCodec;else{if(!this._videoCodec)return;t+=this._videoCodec}this.mimeType=t+'"'}},{key:"getUint64",value:function(t,e){var r=t.getUint32(e),i=t.getUint32(e+4);return r*this.uint32_max+i}},{key:"setUint64",value:function(t,e,r){t.setUint32(e,r>=this.uint32_max?Math.floor(r/this.uint32_max):0),t.setUint32(e+4,4294967295&r)}}])&&a(e.prototype,r),i&&a(e,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.exports.t=_},615:t=>{function e(t,e){var i="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!i){if(Array.isArray(t)||(i=function(t,e){if(t){if("string"==typeof t)return r(t,e);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?r(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){i&&(t=i);var n=0,a=function(){};return{s:a,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){i=i.call(t)},n:function(){var t=i.next();return s=t.done,t},e:function(t){u=!0,o=t},f:function(){try{s||null==i.return||i.return()}finally{if(u)throw o}}}}function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===i(a)?a:String(a)),n)}var a}function o(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var s=function(){function t(){n(this,t),this.version=void 0,this.sequence=void 0,this.nextSequence=void 0,this.endOfStream=void 0,this.steering=null,this.files=[],this.streams=[],this.streamInfMaps=[]}return o(t,[{key:"parse",value:function(t,e){for(var r=null,i=null,n=0,a=null,o=null,s=null,u=t.length,l=0;l<u;){var h=t.indexOf("\n",l);-1===h&&(h=u);var c=t.substring(l,h);if(l=h+1,0!==c.length)if("#"===c[0]){var f=c.indexOf(":");if(f>0){var d=c.substring(0,f),_=c.substring(f+1);if("#EXTINF"===d){var y=_.lastIndexOf(",");r=-1!==y?_.substring(0,y):_.substring(0),i=-1!==y?_.substring(y+1,_.length):null,n=1}else if("#EXT-BILI-AUX"===d)a=this._parseBiliAux(_);else if("#EXT-X-VERSION"===d)this.version=parseInt(_.trim());else if("#EXT-X-MEDIA-SEQUENCE"===d)this.sequence=parseInt(_.trim()),this.nextSequence=this.sequence;else if("#EXT-X-MAP"===d){var p=_.trim();if(p.length<=5||'URI="'!==p.substring(0,5))return console.warn("wrong #EXT-X-MAP: ".concat(_)),-2;var v=(p=p.substring(5)).lastIndexOf('"');p=-1!==v?p.substring(0,v):p.substring(0),this.files.push({uri:p,duration:void 0,title:"",biliAux:void 0,seq:void 0,src:e})}else"#EXT-X-STREAM-INF"===d?(o=this._parseMultiKV(_),n=2):"#EXT-X-CONTENT-STEERING"===d&&(s=this._parseMultiKV(_))}else"#EXT-X-ENDLIST"===c&&(this.endOfStream=!0)}else 1===n?(this._lastSeq=this.nextSequence++,this._lastUri=c.trim(),this.files.push({uri:this._lastUri,duration:r.trim(),title:i,biliAux:a,seq:this._lastSeq,src:e}),r=null,i=null,n=0,a=null):2===n&&(this.streams.push(c),this.streamInfMaps.push(o),this.steering=s,n=0,o=null)}return 0}},{key:"trimStart",value:function(t){if(this.files.length>0)for(var e=t/1e3,r=0,i=null,n=null,a=this.files.length-1;a>=0;a--){var o=this.files[a];if(void 0!==o.seq)r+=parseFloat(o.duration),null===n&&o.biliAux&&r>=e&&"K"===o.biliAux.firstFrameType&&(n=a);else if(null===i&&null!==n){i=o;var s=this.files.slice(n,this.files.length);s.unshift(i),this.files=s;break}}}},{key:"_parseMultiKV",value:function(t){for(var e,r=new Map,i=new RegExp('(\\w+?)\\=(([^"]|("[^"]+"))+?)(,|$)',"gm");null!==(e=i.exec(t));)if(e.index===i.lastIndex&&i.lastIndex++,e.length>=3){var n=e[1],a=e[2];a.startsWith('"')&&a.endsWith('"')&&(a=a.substring(1,a.length-1)),r.set(n,a)}return r}},{key:"_parseBiliAux",value:function(t){var e=t.split("|");return{pts:e.length>0?Number.parseInt(e[0],16):void 0,firstFrameType:e.length>1?e[1]:void 0,size:e.length>2?Number.parseInt(e[2],16):void 0,crc:e.length>3?Number.parseInt(e[3],16):void 0}}}]),t}(),u=function(){function t(e){n(this,t),this.onPlaylistUpdate=function(t,e){},this.endOfStream=!1,this.mimeType=null,this.steering=null,this.streamUrls=[],this.streamInfMaps=[],this._initUris=new Set,this._lastSeq=0,this._lastUri=null,this._nextSequence=void 0,this._remainDuration=0,this._totalCount=0,this._totalDuration=0,this._dataUrls=[],this._url=null,this._trimStartKeepTimeMs=e,this._needTrimStart=e>0,this._nextPlaylist=null,this.onSwitchToNextPlaylist=null}return o(t,[{key:"setUrl",value:function(t){var e=t.lastIndexOf("/"),r=t.lastIndexOf("?");this._relativePath=t.substring(0,e+1),this._queryParams=r>0?t.substring(r):null,this._url=t,this._initUris.clear(),this._lastSeq=0,this._lastUri=null,this._nextSequence=void 0,this._nextPlaylist=null}},{key:"switchToNewPlaylist",value:function(t,e){if(t){if(!e)return!1;var r=new s;return 0==r.parse(e,t)&&(this._nextPlaylist={url:t,parser:r},!0)}return this._nextPlaylist=null,!0}},{key:"count",get:function(){return this._dataUrls.length}},{key:"averageDuration",get:function(){return this._totalCount>0?this._totalDuration/this._totalCount:0}},{key:"lastSequence",get:function(){return this._nextSequence>0?this._nextSequence-1:0}},{key:"remainDuration",get:function(){return this._remainDuration}},{key:"parse",value:function(t){var e=new s,r=e.parse(t,this._url);if(0!=r)return r;if(this.streamUrls=e.streams,this.streamInfMaps=e.streamInfMaps,this.steering=e.steering,this.streamUrls.length>0)return 1;if(void 0===e.version||e.version<6)return console.warn("wrong #EXT-X-VERSION: ".concat(e.version)),-1;this._needTrimStart&&(this._needTrimStart=!1,e.trimStart(this._trimStartKeepTimeMs));var i=this._mergeNextList(e);return 0!=i||this._doPlaylistSwitch(),i}},{key:"_mergeNextList",value:function(t){void 0!==t.endOfStream&&(this.endOfStream=t.endOfStream);var r,i=!1,n=!1,a=e(t.files);try{for(a.s();!(r=a.n()).done;){var o=r.value;if(void 0===o.seq&&(i=!0,!this._initUris.has(o.uri))){n=!0;break}}}catch(t){a.e(t)}finally{a.f()}if(0==i&&!t.endOfStream)return console.warn("missing #EXT-X-MAP URI"),-2;if(this._nextSequence!==t.nextSequence||n){if(void 0===this._nextSequence&&(this._nextSequence=t.sequence),this._nextSequence<t.sequence&&this._nextSequence+30>=t.sequence&&this._lastUri){console.warn("lost sequence: ".concat(this._nextSequence," -> ").concat(t.sequence));for(var s=this.averageDuration,u=this._lastSeq.toString(),l=t.sequence-1;l>=this._nextSequence;l--){var h=this._lastUri.replace(u,l.toString());t.files.unshift({uri:h,duration:s})}}var c,f=e(t.files);try{for(f.s();!(c=f.n()).done;){var d=c.value;if(d.seq>=this._nextSequence||void 0===d.seq){if(void 0===d.seq){if(this._initUris.has(d.uri))continue;this._initUris.add(d.uri)}d.duration=parseFloat(d.duration),isNaN(d.duration)&&(d.duration=this.averageDuration),this._appendEntry(d)}}}catch(t){f.e(t)}finally{f.f()}this._nextSequence<t.nextSequence&&(this._nextSequence=t.nextSequence)}return 0}},{key:"_doPlaylistSwitch",value:function(){if(this._nextPlaylist){var t=this._nextPlaylist.parser,e=this._nextPlaylist.url,r=this.onSwitchToNextPlaylist,i=0,n=0;for(i=0;i<t.files.length;++i){var a=t.files[i];if(null!=a.seq&&null!=a.biliAux&&"K"==a.biliAux.firstFrameType&&null!=a.biliAux.pts){for(n=0;n<this._dataUrls.length;++n){var o=this._dataUrls[n];if(null!=o.biliAux&&null!=o.biliAux.pts&&o.biliAux.pts==a.biliAux.pts)break}if(n<this._dataUrls.length)break}}if(i==t.files.length)return!1;this._removeEntries(n),this.setUrl(e),this._nextSequence=t.files[i].seq,r(0==this._mergeNextList(t)),this._nextPlaylist=null}return!0}},{key:"shift",value:function(){var t=this._dataUrls.length>0?this._dataUrls.shift():null;return t&&(this._remainDuration-=t.duration),t}},{key:"_appendEntry",value:function(t){t.uri=this._buildM4sUrl(t.uri),this._dataUrls.push(t),this.onPlaylistUpdate(!1,t),this._remainDuration+=t.duration,this._totalCount++,this._totalDuration+=t.duration}},{key:"_removeEntries",value:function(t){if(t>this._dataUrls.length)return!1;for(var e=this._dataUrls.length,r=e-t,i=t;i<e;++i){var n=this._dataUrls[i];this._remainDuration-=n.duration,this._totalCount--,this._totalDuration-=n.duration}this._nextSequence-=r,this._lastSeq-=r,this._dataUrls.splice(t,r)}},{key:"_buildM4sUrl",value:function(t){var e=-1!==t.indexOf("://")?t:this._relativePath+t;return null!==this._queryParams&&(-1!==t.indexOf("?")?e+="&"+this._queryParams.substring(1):e+=this._queryParams),e}}]),t}();t.exports={M3u8Context:u,BasicM3u8Parser:s,parsedOk:0,parsedAsMaster:1,parsedErrorVer:-1,parsedErrorInit:-2}},497:(t,e,r)=>{function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){var r="undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(!r){if(Array.isArray(t)||(r=function(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(t))||e&&t&&"number"==typeof t.length){r&&(t=r);var i=0,n=function(){};return{s:n,n:function(){return i>=t.length?{done:!0}:{done:!1,value:t[i++]}},e:function(t){throw t},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,u=!1;return{s:function(){r=r.call(t)},n:function(){var t=r.next();return s=t.done,t},e:function(t){u=!0,o=t},f:function(){try{s||null==r.return||r.return()}finally{if(u)throw o}}}}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,i=new Array(e);r<e;r++)i[r]=t[r];return i}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===i(a)?a:String(a)),n)}var a}var s=r(757),u=function(){function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)}var e,r;return e=t,(r=[{key:"_readSeiNumber",value:function(t,e){for(var r=0;e.offset<t.byteLength;){var i=t[e.offset];if(e.offset+=1,255!==i)return r+i;r+=255}return null}},{key:"_isEndOfSei",value:function(t,e){return e.offset>=t.byteLength||128===t[e.offset]&&(e.offset+=1,!0)}},{key:"_readSeiMessage",value:function(t,e){var r=this._readSeiNumber(t,e),i=this._readSeiNumber(t,e);if(null!==r&&null!==i){var n=e.offset+i;if(n<t.byteLength){var a={payloadType:r,payloadData:t.subarray(e.offset,n)};return e.offset+=i,a}}return null}},{key:"readSeiMessages",value:function(t){for(var e=[],r={offset:0};!this._isEndOfSei(t,r);){var i=this._readSeiMessage(t,r);if(null===i)break;e.push(i)}return e}},{key:"parse",value:function(e,r,i,a,o,u,l,h){for(var c=r+i,f=r;f+u<c;){for(var d=0,_=0;_<u;_++)d=d<<8|e[f++];var y=f+d;if(y>c||y<=f)break;if((l?e[f++]>>1:31&e[f])==(l?39:6)){var p,v=s.ebsp2rbsp(e.subarray(f+1,y)),m=n(t.readSeiMessages(v));try{for(m.s();!(p=m.n()).done;){var b=p.value;5===b.payloadType&&b.payloadData.length>=16&&h(a,o,b.payloadData.slice(0,16),b.payloadData.slice(16))}}catch(t){m.e(t)}finally{m.f()}}f=y}}}])&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.exports.$=u},41:t=>{function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,r){for(var i=0;i<r.length;i++){var n=r[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=function(t,r){if("object"!==e(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!==e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===e(a)?a:String(a)),n)}var a}function i(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var a=i(function t(e){n(this,t),this.trakBoxOffset=e,this.handler=void 0,this.trackId=void 0,this.language=void 0,this.isDefault=void 0,this.label=void 0}),o=i(function t(e){n(this,t),this.trafBoxOffset=e,this.trackId=void 0});t.exports={fMp4Track:a,fMp4TrackFragment:o}},15:t=>{t.exports.e=function(t,e){for(var r=0,i=t.length;0!=i;){var n=i>>1,a=r+n;t[a]<e?(r=++a,i-=n+1):i=n}return r}},221:t=>{var e=void 0;t.exports.checkChromeVer=function(){if(void 0!==e)return e;try{var t=navigator.userAgent,r=t.indexOf("Chrome/");if(r>0){r+=7;var i=t.indexOf(".",r);return-1===i&&(i=t.length),e=parseInt(t.substring(r,i)),console.log("Chrome verion: ".concat(e)),e}}catch(t){console.warn("parse Chrome version failed",t)}return e=0}},704:t=>{function e(t){return(e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,r){for(var i=0;i<r.length;i++){var n=r[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=function(t,r){if("object"!==e(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var n=i.call(t,"string");if("object"!==e(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===e(a)?a:String(a)),n)}var a}var i=function(){function t(e){var r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1e3;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._player=e,this._minBufferMs=r,this._loaded=!1,this._waitCount=0,this._waitDuration=0,this._waiting=!1,this._beginWaitTime=0,this._savedPaused=void 0,this._timer=void 0,this.minWaitMs=100,this._onLoadedDataBinder=this._onLoadedData.bind(this),this._onPlayingBinder=this._onPlaying.bind(this),this._onWaitingBinder=this._onWaiting.bind(this),e.addEventListener("loadeddata",this._onLoadedDataBinder),e.addEventListener("playing",this._onPlayingBinder),e.addEventListener("waiting",this._onWaitingBinder)}var e,i;return e=t,(i=[{key:"destroy",value:function(){this._clearTimer(),this._player.removeEventListener("waiting",this._onWaitingBinder),this._player.removeEventListener("playing",this._onPlayingBinder),this._player.removeEventListener("loadeddata",this._onLoadedDataBinder),this._waitCount=0,this._waitDuration=0}},{key:"buffered",get:function(){var t=this._player.buffered;return t&&t.length>0?t.end(t.length-1)-this._player.currentTime:0}},{key:"waitedCount",get:function(){return this._waitCount}},{key:"waitedDuration",get:function(){return Math.round(this._waitDuration)}},{key:"_onLoadedData",value:function(t){this._loaded=!0}},{key:"_onPlaying",value:function(t){if(this._waiting){var e=performance.now()-this._beginWaitTime;e>this.minWaitMs&&(this._waitCount++,this._waitDuration+=e),this._waiting=!1}}},{key:"_onWaiting",value:function(t){var e=this;if(this._loaded&&!this._player.seeking){var r=this._player.readyState;if(!(r===HTMLMediaElement.HAVE_ENOUGH_DATA||r===HTMLMediaElement.HAVE_CURRENT_DATA&&this.buffered>=2)&&(this._waiting=!0,this._beginWaitTime=performance.now(),this._savedPaused=void 0,this._clearTimer(),this._minBufferMs>this.minWaitMs)){var i=this._minBufferMs/1e3,n=this._beginWaitTime+this._minBufferMs+1e3;this._timer=window.setInterval(function(){!e._waiting||e.buffered>=i||performance.now()>=n?(e._clearTimer(),!e._savedPaused&&e._player.paused&&e._player.play().then(function(){}).catch(function(t){})):void 0===e._savedPaused&&(e._savedPaused=!!e._player.paused,e._player.pause())},2*this.minWaitMs)}}}},{key:"_clearTimer",value:function(){void 0!==this._timer&&(window.clearInterval(this._timer),this._timer=void 0)}}])&&r(e.prototype,i),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.exports._=i},97:(t,e,r)=>{function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function n(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===i(a)?a:String(a)),n)}var a}function o(t,e,r){return e&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}var s=r(319),u=!!window.fetch,l=!!window.ReadableStream,h=function(){function t(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n(this,t),this._callbackMap=new Map,this._onResponse=e,this._onResult=r,this._onError=i}return o(t,[{key:"fetchAsBuffer",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this._setTimeout(t,r);u?this._doFetch(t,e,"arrayBuffer",i):this._doRequest(t,"arraybuffer",i)}},{key:"fetchAsJson",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this._setTimeout(t,r);u?this._doFetch(t,e,"json",i):this._doRequest(t,"json",i)}},{key:"fetchAsText",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]&&arguments[1],r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,i=this._setTimeout(t,r);u?this._doFetch(t,e,"text",i):this._doRequest(t,"text",i)}},{key:"fetchAsStream",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(l){var n=this._setTimeout(t,i);fetch(t,r?{}:{cache:"no-store"}).then(function(r){if(void 0===n||e._clearTimeout(n))if(e._onResponse(t,r)&&r.ok){var i=r.body.getReader(),a=[],o=function(r){!r.done&&a[0]?a[0]():a[0]=null,e._onResult(t,r.value,r.done)};a[0]=function(){i.read().then(o).catch(function(r){e._onError(t,s.errorNetworkRead,r)})},a[0]()}else r.body.getReader().cancel()}).catch(function(r){(void 0===n||e._clearTimeout(n))&&e._onError(t,s.errorNetworkFetch,r)})}else this.fetchAsBuffer(t,r,i)}},{key:"_doFetch",value:function(t,e,r,i){var n=this;fetch(t,e?{}:{cache:"no-store"}).then(function(e){(void 0===i||n._clearTimeout(i))&&(n._onResponse(t,e)&&e.ok?e[r]().then(function(e){n._onResult(t,e,!0)}).catch(function(e){n._onError(t,s.errorNetworkRead,e)}):e.body.getReader().cancel())}).catch(function(e){(void 0===i||n._clearTimeout(i))&&n._onError(t,s.errorNetworkFetch,e)})}},{key:"_doRequest",value:function(t,e,r){var i=this,n=new XMLHttpRequest;n.onreadystatechange=function(e){(void 0===r||i._clearTimeout(r))&&2===n.readyState&&(n.ok=n.status>=200&&n.status<=299,i._onResponse(t,n))},n.onload=function(e){n.status>=200&&n.status<=299&&i._onResult(t,n.response,!0)},n.onerror=function(e){(void 0===r||i._clearTimeout(r))&&i._onError(t,n.readyState>2?s.errorNetworkRead:s.errorNetworkFetch,e)},n.open("GET",t),n.responseType=e,n.send()}},{key:"_clearTimeout",value:function(t){return void 0!==t&&(window.clearTimeout(t),this._callbackMap.delete(t))}},{key:"_setTimeout",value:function(t,e){var r=this;if(e>0){var i=[];return i[0]=window.setTimeout(function(){r._callbackMap.delete(i[0]),r._onError(t,s.errorNetworkTimeout,e)},e),this._callbackMap.set(i[0],1),i[0]}}}]),t}(),c=function(){function t(e,r){var i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;n(this,t),this._readDone=!1,this._reader=null,this._onResponse=e,this._onData=r,this._onError=i,this._onDataFetchedBinder=this._onDataFetched.bind(this),this._onReadErrorBinder=this._onReadError.bind(this)}return o(t,[{key:"destroy",value:function(){this._readDone=!0,this._onData=null}},{key:"fetchAsStream",value:function(t){var e=this,r=arguments.length>1&&void 0!==arguments[1]&&arguments[1],i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:-1,a=arguments.length>4&&void 0!==arguments[4]?arguments[4]:0,o={};if(0!=i){var u={};u.Range="bytes=".concat(i,"-")+(n>0?(n-1).toString():""),o.headers=u}r||(o.cache="no-store");var l=a>0?window.setTimeout(function(){e._onError(s.errorNetworkTimeout,a)},a):void 0;fetch(t,o).then(function(t){e._clearTimeout(l),e._reader&&(e._reader.cancel(),e._reader=null),e._onResponse(t)&&t.ok?(e._readDone=!1,e._reader=t.body.getReader(),e._reader.read().then(e._onDataFetchedBinder).catch(e._onReadErrorBinder)):t.body.getReader().cancel()}).catch(function(t){e._clearTimeout(l),e._onError(s.errorNetworkFetch,t)})}},{key:"_onDataFetched",value:function(t){t.done&&(this._reader=null,this._readDone=!0),this._reader&&(this._readDone?(this._reader.cancel(),this._reader=null):this._reader.read().then(this._onDataFetchedBinder).catch(this._onReadErrorBinder)),this._onData&&!this._onData(t.value)&&(this._readDone=!0,this._reader&&(this._reader.cancel(),this._reader=null))}},{key:"_onReadError",value:function(t){this._onError(s.errorNetworkRead,t)}},{key:"_clearTimeout",value:function(t){void 0!==t&&window.clearTimeout(t)}}]),t}();t.exports={Fetcher:h,StreamFetcher:c}},483:(t,e,r)=>{function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var n=r(319),a=function(){function t(e,r,i){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._mediaSource=e,this._onEnded=r,this._onError=i,this._dataList=[],this._mimeType=null,this._sourceOpened=!1,this._sourceBuffer=null,this._eosBuffer=new Uint8Array,this._onSourceOpenBinder=this._onSourceOpen.bind(this),this._onUpdateEndBinder=this._onUpdateEnd.bind(this),e&&e.addEventListener("sourceopen",this._onSourceOpenBinder)}var e,r;return e=t,(r=[{key:"destroy",value:function(){this.removeSource(),this._dataList.length=0,this._mediaSource=null,this._mimeType=null,this._sourceOpened=!1}},{key:"addSource",value:function(t){if(this._mimeType=t,t&&this._sourceOpened&&!this._sourceBuffer)try{this._sourceBuffer=this._mediaSource.addSourceBuffer(t),this._sourceBuffer&&this._sourceBuffer.addEventListener("updateend",this._onUpdateEndBinder)}catch(t){this._onError&&this._onError(n.errorMseOpen,t)}return null!==this._sourceBuffer}},{key:"removeSource",value:function(){this._sourceBuffer&&(this._sourceBuffer.removeEventListener("updateend",this._onUpdateEndBinder,!1),this._mediaSource.removeSourceBuffer(this._sourceBuffer),this._sourceBuffer=null)}},{key:"pushBuffer",value:function(t){this._dataList.push(t),this._onUpdateEnd()}},{key:"pushEnd",value:function(){0!==this._dataList.length||this._sourceBuffer?(this._dataList.push(this._eosBuffer),this._onUpdateEnd()):this._onEnded&&this._onEnded()}},{key:"removeBuffer",value:function(t,e){try{if(!this._sourceBuffer.updating)return this._sourceBuffer.remove(t,e),!0}catch(r){console.warn("remove buffer failed: ".concat(t," -> ").concat(e),r)}return!1}},{key:"_onSourceOpen",value:function(){this._mediaSource&&(this._mediaSource.duration=1/0,this._mediaSource.removeEventListener("sourceopen",this._onSourceOpenBinder),this._sourceOpened=!0,this._mimeType&&this.addSource(this._mimeType))}},{key:"_onUpdateEnd",value:function(){var t=this._sourceBuffer;if(t&&!t.updating){var e=this._dataList;if(e.length){var r=e.shift();try{r===this._eosBuffer?("open"===this._mediaSource.readyState&&this._mediaSource.endOfStream(),this._onEnded&&this._onEnded()):null!==r&&t.appendBuffer(r),r=null}catch(t){"QuotaExceededError"===t.name?r&&e.unshift(r):this._onError&&this._onError(n.errorMseAppend,t)}}}}}])&&function(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,(a=function(t,e){if("object"!==i(t)||null===t)return t;var r=t[Symbol.toPrimitive];if(void 0!==r){var n=r.call(t,"string");if("object"!==i(n))return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(n.key),"symbol"===i(a)?a:String(a)),n)}var a}(e.prototype,r),Object.defineProperty(e,"prototype",{writable:!1}),t}();t.exports.E=a}},e={},function r(i){var n=e[i];if(void 0!==n)return n.exports;var a=e[i]={exports:{}};return t[i](a,a.exports,r),a.exports}(35);var t,e});
})()