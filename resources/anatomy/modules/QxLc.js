/**
 * id: QxLc
 * path: ./mask-decoder
 */

(function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var t=10;function e(t,e){for(var a=0,n=0,o=0,r=0,u=0,c=0,f=0,l="",h=0,v=0,m=0,b=0,g=0,p=0,k=new DataView(t.buffer,0,e);a<e;){var d=s(t,a,e);switch(a=d.bufPos,d.value){case 1:a=(d=s(t,a,e)).bufPos;break;case 2:a=(d=i(k,a,e)).bufPos,n=d.value,a=(d=i(k,a,e)).bufPos,o=d.value,a=(d=i(k,a,e)).bufPos,r=d.value,a=(d=i(k,a,e)).bufPos,u=d.value,a=(d=i(k,a,e)).bufPos,c=d.value,a=(d=i(k,a,e)).bufPos,f=d.value;break;case 3:l+="z ";break;case 4:a=(d=s(t,a,e)).bufPos,h=d.value,a=(d=s(t,a,e)).bufPos,v=d.value,l+="M"+h.toString()+" "+v.toString()+" ";break;case 5:a=(d=s(t,a,e)).bufPos,h=d.value,a=(d=s(t,a,e)).bufPos,v=d.value,l+="m"+h.toString()+" "+v.toString()+" ";break;case 6:a=(d=s(t,a,e)).bufPos,h=d.value,a=(d=s(t,a,e)).bufPos,v=d.value,l+="L"+h.toString()+" "+v.toString()+" ";break;case 7:a=(d=s(t,a,e)).bufPos,h=d.value,a=(d=s(t,a,e)).bufPos,v=d.value,l+="l"+h.toString()+" "+v.toString()+" ";break;case 8:a=(d=s(t,a,e)).bufPos,h=d.value,a=(d=s(t,a,e)).bufPos,v=d.value,a=(d=s(t,a,e)).bufPos,m=d.value,a=(d=s(t,a,e)).bufPos,b=d.value,a=(d=s(t,a,e)).bufPos,g=d.value,a=(d=s(t,a,e)).bufPos,p=d.value,l+="C"+h.toString()+" "+v.toString()+" "+m.toString()+" "+b.toString()+" "+g.toString()+" "+p.toString()+" ";break;case 9:a=(d=s(t,a,e)).bufPos,h=d.value,a=(d=s(t,a,e)).bufPos,v=d.value,a=(d=s(t,a,e)).bufPos,m=d.value,a=(d=s(t,a,e)).bufPos,b=d.value,a=(d=s(t,a,e)).bufPos,g=d.value,a=(d=s(t,a,e)).bufPos,p=d.value,l+="c"+h.toString()+" "+v.toString()+" "+m.toString()+" "+b.toString()+" "+g.toString()+" "+p.toString()+" "}}return 0===l.length?"":'<?xml version="1.0" standalone="no"?>\n  <svg version="1.0" xmlns="http://www.w3.org/2000/svg"\n      width="'.concat(n,'px" height="').concat(o,'px" viewBox="0 0 ').concat(n," ").concat(o,'"\n      preserveAspectRatio="xMidYMid meet">\n      <g transform="translate(').concat(r,", ").concat(u,") scale(").concat(c,", ").concat(f,')"\n      fill="#000000" stroke="none" shape-rendering="optimizeSpeed">\n      <path d="').concat(l,'"></path>\n      </g>\n  </svg>')}function s(e,s,i){for(var n=0,o=0;s<i&&n<t;){var r=e[s],u=127&r;if(o+=u<<=7*n,n++,s++,0==(128&r))return{bufPos:s,value:a(o)}}return{bufPos:-1,value:-1}}function a(t){return t>>1^1+~(1&t)}function i(t,e,s){return e+4>s?{bufPos:-1,value:-1}:{bufPos:e+4,value:t.getFloat32(e)}}var n=function(){function t(){this.currentTime=0,this.currentMask="",this.hasVideoInfo=!1,this.videoInfo={direction:"",padding:0},this._masks=[]}return t.prototype.clear=function(){this._masks.splice(0,this._masks.length)},t.prototype.input=function(t,s){var a=e(s,s.length);""!==a&&this._addMask({timestamp:t,mask:a})},t.prototype.output=function(t){if(0===this._masks.length)return null;for(var e=0,s=t-this._masks[0].timestamp,a=Math.abs(s),i=1;i<this._masks.length;++i){var n=Math.abs(t-this._masks[i].timestamp),o=Math.abs(n);if(!(o<=a))break;e=i,s=n,a=o}var r=this._masks[e];return this._masks.splice(0,e),r},t.prototype._addMask=function(t){if(0===this._masks.length)this._masks.push(t);else{for(var e=this._masks.length-1;e>=0;--e){if(this._masks[e].timestamp<t.timestamp){e+=1;break}}this._masks.splice(e,0,t),e>0&&this._masks[e].timestamp<this._masks[e-1].timestamp&&this._masks.splice(0,e)}},t.equalsUuid=function(t,e){if(16!==t.length||16!==e.length)return!1;for(var s=0;s<16;++s)if(t[s]!==e[s])return!1;return!0},t.prototype.onUpdateMask=function(t,e){var s=t.currentTime;this.getVideoInfo(t);var a=this.output(s);if(null!=this.currentTime&&this.currentTime-s>1&&e.style.removeProperty("-webkit-mask-image"),null==a||null==a.mask||a.mask===this.currentMask)return this.currentMask="",void(this.currentTime=0);var i=a.mask;if(null===i||i===this.currentMask)return this.currentMask="",void(this.currentTime=0);if(a.timestamp-s<=1&&this.hasVideoInfo){var n="data:image/svg+xml;base64,"+btoa(i),o="linear-gradient(\n        to ".concat(this.videoInfo.direction,",\n        rgb(0,0,0,1),\n        rgb(0,0,0,1) ").concat(this.videoInfo.padding,"%,\n        rgb(0,0,0,0) ").concat(this.videoInfo.padding,"%,\n        rgba(0,0,0,0) ").concat(100-this.videoInfo.padding,"%,\n        rgba(0,0,0,1) ").concat(100-this.videoInfo.padding,"%,\n        rgba(0,0,0,1)),\n        url(").concat(n,")");e.style.cssText+="\n        -webkit-mask-image: ".concat(o,";\n        -webkit-mask-size: contain;\n        mask-size: contain;\n        -webkit-mask-repeat: no-repeat;\n        mask-repeat: no-repeat;\n        -webkit-mask-position: center center;\n        mask-position: center center;\n      "),this.currentMask=i,this.currentTime=a.timestamp}},t.prototype.destroy=function(){this._masks=[]},t.prototype.getVideoInfo=function(t){var e,s,a=t.videoHeight,i=t.videoWidth,n=t.clientHeight,o=t.clientWidth,r=t.clientHeight,u=t.clientWidth;if(0===a||0===i)return!1;i/a>o/n?(s="bottom",e=Math.ceil((n-a*o/i)/(2*r)*100*100)/100):(s="right",e=Math.ceil((o-i*n/a)/(2*u)*100*100)/100),this.hasVideoInfo=!0,this.videoInfo={direction:s,padding:e}},t}();exports.default=n;
})()