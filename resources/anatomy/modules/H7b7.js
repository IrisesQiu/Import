/**
 * id: H7b7
 * path: ./switch-better-line
 */

(function(require,module,exports) {
"use strict";var e=this&&this.__classPrivateFieldGet||function(e,t,n,i){if("a"===n&&!i)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof t?e!==t||!i:!t.has(e))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===n?i:"a"===n?i.call(e):i?i.value:t.get(e)},t=this&&this.__classPrivateFieldSet||function(e,t,n,i,r){if("m"===i)throw new TypeError("Private method is not writable");if("a"===i&&!r)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof t?e!==t||!r:!t.has(e))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===i?r.call(e,n):r?r.value=n:t.set(e,n),n};Object.defineProperty(exports,"__esModule",{value:!0}),exports.SwitchBetterLine=void 0;var n=5,i=8e3,r=6e4,a=1e4,o=5e3,s=0,f=function(){function f(v,m){var l=this;this.video=v,this.opts=m,c.set(this,!1),w.set(this,[]),h.set(this,0),u.set(this,0),p.set(this,[]),this.getNeedSwitchLine=function(){return e(l,c,"f")},this.destroy=function(){e(l,p,"f").forEach(function(e){return e()}),t(l,p,[],"f")},d.set(this,function(d){var v=0;s=performance.now();var m=function(){e(l,c,"f")?f.switchNum+=1:v=performance.now()},g=function(){if(!(s+a>performance.now()||0===v||e(l,u,"f")+o>=performance.now())){var f={duration:performance.now()-v,waitingStartTime:v};e(l,w,"f").push(f),t(l,w,e(l,w,"f").filter(function(n){return n.waitingStartTime+r<performance.now()&&t(l,h,e(l,h,"f")-n.duration,"f"),n.waitingStartTime+r>=performance.now()}),"f"),t(l,h,e(l,w,"f").reduce(function(e,t){return e+t.duration},0),"f"),(e(l,h,"f")>i||e(l,w,"f").length>=n)&&t(l,c,!0,"f")}},E=function(){t(l,u,performance.now(),"f")};d.addEventListener("playing",g),d.addEventListener("seeking",E),d.addEventListener("waiting",m),e(l,p,"f").push(function(){d.removeEventListener("seeking",E),d.removeEventListener("playing",g),d.removeEventListener("waiting",m)})}),f.switchNum+1!==this.opts.lineNum&&e(this,d,"f").call(this,v)}var c,w,h,u,p,d;return c=new WeakMap,w=new WeakMap,h=new WeakMap,u=new WeakMap,p=new WeakMap,d=new WeakMap,f.switchNum=0,f.lastSwitchTime=0,f}();exports.SwitchBetterLine=f;
})()