/**
 * id: Rvqf
 * path: ./haptic
 */

(function(require,module,exports) {
"use strict";var t=this&&this.__classPrivateFieldSet||function(t,e,a,n,i){if("m"===n)throw new TypeError("Private method is not writable");if("a"===n&&!i)throw new TypeError("Private accessor was defined without a setter");if("function"==typeof e?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return"a"===n?i.call(t,a):i?i.value=a:e.set(t,a),a},e=this&&this.__classPrivateFieldGet||function(t,e,a,n){if("a"===a&&!n)throw new TypeError("Private accessor was defined without a getter");if("function"==typeof e?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return"m"===a?n:"a"===a?n.call(t):n?n.value:e.get(t)};Object.defineProperty(exports,"__esModule",{value:!0}),exports.WebHaptic=void 0;var a=!1,n=function t(){a=!0,window.removeEventListener("touchstart",t),window.removeEventListener("click",t)};window.addEventListener("touchstart",n),window.addEventListener("click",n);var i=function(){function n(b){void 0===b&&(b=!0);var k=this;i.set(this,!1),o.set(this,0),r.set(this,0),s.set(this,!1),c.set(this,!0),f.set(this,[]),l.set(this,void 0),d.set(this,void 0),p.set(this,1e3),u.set(this,-1),this.enableControllerHaptic=function(){t(k,c,!0,"f")},this.disableControllerHaptic=function(){t(k,c,!1,"f")},this.dispose=function(){k.setState(0,0),e(k,s,"f")&&(window.removeEventListener("gamepadconnected",e(k,l,"f")),window.removeEventListener("gamepaddisconnected",e(k,d,"f")))},this.setState=function(a,n){clearTimeout(e(k,u,"f")),e(k,w,"f").call(k,a,n),e(k,v,"f").call(k,a,n),(a>0||n>0)&&t(k,u,window.setTimeout(function(){t(k,u,-1,"f"),k.setState(0,0)},e(k,p,"f")),"f")},w.set(this,function(s,c){if(n.IsSupportWebHaptic()){var f=Math.max(s,.5*c);if(f!==e(k,o,"f")){if(t(k,o,f,"f"),t(k,r,f/65535,"f"),!a)return;f>0?e(k,i,"f")||(t(k,i,!0,"f"),e(k,m,"f").call(k,k)):(t(k,i,!1,"f"),window.navigator.vibrate(0))}}}),v.set(this,function(t,a){var n;if(e(k,s,"f"))for(var i=t/65535,o=a/65535,r=0,c=Object.entries(e(k,f,"f"));r<c.length;r++){var l=c[r],d=(l[0],l[1]);null!=d&&(null===(n=null==d?void 0:d.vibrationActuator)||void 0===n||n.playEffect("dual-rumble",{duration:1e3,strongMagnitude:i,weakMagnitude:o}))}}),this.getMotorPercent=function(){return e(k,r,"f")},h.set(this,function(){t(k,f,navigator.getGamepads(),"f")}),m.set(this,function(t){a&&e(t,o,"f")>0&&e(t,i,"f")&&(e(t,r,"f")<.075?e(t,W,"f").call(t,t,e(t,r,"f")):e(k,r,"f")<.88?e(t,M,"f").call(t,t,e(t,r,"f")):e(t,g,"f").call(t,t,e(t,r,"f")))}),g.set(this,function(t,a){var n=100*a;window.navigator.vibrate(n),setTimeout(function(){e(t,m,"f").call(t,t)},n)}),M.set(this,function(t,a){var n=50*a;window.navigator.vibrate(n),setTimeout(function(){e(t,m,"f").call(t,t)},n)}),W.set(this,function(t,a){var n=100-a/.025*100;window.navigator.vibrate(2),setTimeout(function(){e(t,m,"f").call(t,t)},n)}),t(this,c,b,"f"),e(this,c,"f")&&t(this,s,n.IsSupportControllerHaptic(),"f"),t(this,l,function(t){console.log("A gamepad was connected:"+t.gamepad.id),e(k,h,"f").call(k)},"f"),t(this,d,function(t){console.log("A gamepad was disconnected:"+t.gamepad.id),e(k,h,"f").call(k)},"f"),e(this,s,"f")&&(window.addEventListener("gamepadconnected",e(this,l,"f")),window.addEventListener("gamepaddisconnected",e(this,d,"f")),e(this,h,"f").call(this))}var i,o,r,s,c,f,l,d,p,u,w,v,h,m,g,M,W;return i=new WeakMap,o=new WeakMap,r=new WeakMap,s=new WeakMap,c=new WeakMap,f=new WeakMap,l=new WeakMap,d=new WeakMap,p=new WeakMap,u=new WeakMap,w=new WeakMap,v=new WeakMap,h=new WeakMap,m=new WeakMap,g=new WeakMap,M=new WeakMap,W=new WeakMap,n.IsSupportControllerHaptic=function(){var t,e;return!(null==window.Gamepad||null==window.GamepadHapticActuator||null===(e=null===(t=window.GamepadHapticActuator)||void 0===t?void 0:t.prototype)||void 0===e||!e.hasOwnProperty("playEffect"))},n.IsSupportWebHaptic=function(){return null!=window.navigator.vibrate},n.IsSupport=function(){return n.IsSupportControllerHaptic()||n.IsSupportWebHaptic()},n}();exports.WebHaptic=i;
})()